```{r setup-MGDWI-Differenzialrechnung, include=FALSE}
# ---------------------------------------------------------------------------
#% maintainer:
#%   - Norman Markgraf
#%
# ---------------------------------------------------------------------------
source("../../prelude.R")
initPart(
    "Differenzialrechnung",  # Dateiname ohne Suffix
    "Differenzialrechnung"   # Verzeichnisname im Bildverzeichnis 
    )
pathToImages = getPathToImages()
# ---------------------------------------------------------------------------

```
```{r setup-plots, echo=FALSE}
library(mosaic)
library(ggplot2)
library(plot3D)  # Für mesh und 3d-plot ...
my_base_size <- 3*11
my_font_size <- 12
my_line_size <- 4
my_line_color <- "blue"
my_zero_line_color <- "black"
my_secant_color <- "green"
my_point_color = "red"
my_constant_line_color <- "green"
f <- 1.0
```

# Differenzialrechnung 

## Der Begriff der Stetigkeit

### Stetigkeit

::::::::: {.small}

Eine Funktion $f: D\subseteq \mathbf{R} \to \mathbf{R}$ ist an der Stelle $x_0 \in D$ **stetig**, wenn für alle reellen $h>0$ gilt:
$$\lim_{h \to 0} f(x_0+h) = f(x_0) = \lim_{h \to 0} f(x_0-h)$$

$f$ heißt **stetigen Funktion**, falls $f$ in jedem Punkt $x_0 \in D$ stetig ist.


**Idee:** Eine stetige Funktion hat keine **Sprungstellen** und 
"lässt sich ohne Absetzen durchzeichnen".

:::::: {.columns}
::: {.column width="49%"}
**Beispiel:** Stetige Funktion:


$f:\mathbf{R}\setminus \{-2\} \to \mathbf{R}, x \mapsto y=\frac{2x-1}{x+2}\phantom{\begin{cases}
1 & . \\
0 & \; . \\
1 & \;. \\
\end{cases}}$

```{r echo=FALSE, out.width="80%"}
# f <- 0.8
fkt <- makeFun((2*x-1)/(x+2) ~ x)

x1 <- seq(-3.5,-2.01, 0.01)
y1 <- fkt(x1)

x2 <- seq(-1.99,0.5, 0.01)
y2 <- fkt(x2)

gf_line(y1 ~ x1, 
        color = ~ I(my_line_color),
        size = f*my_line_size) %>% 
  gf_line(y2 ~ x2, 
          color = ~ I(my_line_color),
          size = f * my_line_size) %>%
  gf_labs(x = "x", y = "y") %>%
  gf_theme(theme_bw(base_size = f * my_base_size))
```


:::
::: {.column width="49%"}
**Beispiel:** Unstetige Funktion:

$\text{sgn}:\mathbf{R}\to \mathbf{R}, x \mapsto y:=
\begin{cases}
     +1 & \; \text{falls} \quad x>0 \\
\;\;\,0 & \; \text{falls} \quad x=0 \\
     -1 & \; \text{falls} \quad x<0 \\
\end{cases}$
```{r echo=FALSE, out.width="80%"}
# f <- 0.8
x1 <- seq(-2,0, 0.5)
y1 <- rep(-1,len = length(x1))

x2 <- 0
y2 <- 0

x3 <- seq(0,2, 0.5)
y3 <- rep(1, len = length(x3))

gf_line(y1 ~ x1, 
        color = my_line_color, 
        size = f*my_line_size) %>% 
  gf_point(y2 ~ x2, 
        color = my_line_color, 
        size = f*my_line_size) %>%
  gf_line(y3 ~ x3, 
        color = my_line_color, 
        size = f*my_line_size) %>%
  gf_point(c(1, -1) ~ c(0, 0), 
           color = my_line_color, 
           fill = "white", 
        size = f*my_line_size+1) %>%
  gf_point(c(1, -1) ~ c(0, 0), 
           color = "white", 
        size = f*my_line_size-1) %>%
  gf_labs(x = "x", y = "y") %>%
  gf_refine(scale_y_continuous(breaks = c(-1,0,1))) %>%
  gf_theme(theme_bw(base_size = f*my_base_size)) 

```

:::
::::::
:::::::::


### Nullstellensatz von Bolzano

Sei $f:[a,b] \to \mathbf{R}$ eine *stetige Funktion* mit 
$[a,b] \subset \mathbf{R}$, die zwischen zwei Stellen $a$ und $b$ das 
Vorzeichen wechselt, also $f(a)\cdot f(b) < 0$, so gibt es ein $c \in [a,b]$ 
welches Nullstelle von $f$ ist, also $f(c) =0$.


**Beispiel:**

Die Funktion $f$ hat an den Stellen $f(-2) = 1 > 0$ und $f(4)= -1 <0$ jeweils
ein unterschiedlichen Vorzeichen, also muss zwischen $-2$ und $4$ (mindestens)
eine Nullstelle existieren:

```{r echo=FALSE, out.height="40%"}
# f <- 0.4
gf_fun( cos(0.4*(x+2))  ~ x, 
        color = ~ I(my_line_color), 
        size = ~I(f*my_line_size),
        xlim = c(-2, 6)) %>%
  gf_hline(yintercept = ~ 0,
           color = my_zero_line_color,
           size = f*0.25*my_line_size,
           show.legend = FALSE) %>%
  gf_point(1 ~ -2, 
           color = my_line_color) %>%
  gf_point(-1 ~ 6, 
           color = my_line_color) %>%
  gf_path(c(0, 1) ~ c(-2, -2),
          size = f*0.25*my_line_size,
          linetype = "dotted") %>%
  gf_path(c(0, -1) ~ c(6, 6),
          size = f*0.25*my_line_size,
          linetype = "dotted") %>%
  gf_point(0 ~ 2.5*(3.14/2)-2, 
           color = my_point_color) %>%
  gf_theme(theme_bw(base_size = f*my_base_size)) 
```


### Zwischenwertsatz

Sei $f:[a,b]\to\mathbf{R}$ eine stetige Funktion mit $a,b\in\mathbf{R}$ und 
$a < b$. 
Sei $s$ ein Wert zwischen den beiden Funktionswerten $f(a)$ und $f(b)$. 
Es gilt also $f(a) \le s \le f(b)$ oder $f(b) \le s \le f(a)$.
Dann gibt es mindestens eine reelle Zahl $c \in [a,b]$ mit $f(c)=s$. 


:::::: {.columns}
::: {.column width="49%"}
```{r echo=FALSE, out.width="80%"}
fkt <- makeFun( 2*(50-x)/50*sin(x) ~ x)
# f <- 0.49*0.8
gf_fun(fkt(x) ~x, 
       color = NA, 
       size = ~ I(f * my_line_size),
       xlim = c(-1.5,7.4)) %>%
  gf_point(c(fkt(-1.5), fkt(7.4)) ~ c(-1.5,7.4), color = my_line_color) %>%
  gf_text(c(fkt(-1.5), fkt(7.4)) ~ c(-1.5,7.4), 
          label = c("f(a)", "f(b)"), 
          nudge_y = c(0.25,-0.27), 
          size = f*my_font_size,
          color = my_line_color) %>%
  gf_hline(yintercept = 0.75, 
           size = f * my_line_size,
           color = my_constant_line_color) %>%
  gf_text(0.75 ~ -1.5,
          label = "s", 
          nudge_y = 0.15, 
          size = f*my_font_size,
          color = my_constant_line_color) %>%
  gf_refine(scale_y_continuous(breaks = c()),
            scale_x_continuous(breaks = c())) %>%
  gf_theme(theme_bw(base_size = f*my_base_size)) 
```

:::
::: {.column width="49%"}
```{r echo=FALSE, out.width="80%"}
#f <- 0.49*0.8

fkt <- makeFun(2*(50-x)/50*sin(x) ~ x)
x_values <- c(-1.5, 7.4)
tdf <- tibble(
          y = fkt(x_values), 
          x = x_values
       )

gf_fun(fkt(x) ~ x,
       color = ~ I(my_line_color),
       size = ~ I(f * my_line_size),
       xlim = x_values) %>%
  gf_point(y ~ x , 
           color = my_line_color, 
           size = f * 1.5 * my_line_size,
           data = tdf) %>%
  gf_text(c(fkt(-1.5), fkt(7.4)) ~ c(-1.5, 7.4), 
          label = c("f(a)", "f(b)"), 
          nudge_y = c(0.25,-0.27), 
          size = f*my_font_size,
          color = my_line_color) %>%
  gf_hline(yintercept = 0.75,
           size = f * my_line_size,
           color = my_constant_line_color) %>%  
  gf_point(0.75 ~ 0.38, 
           size = f * 1.5 * my_line_size, 
           color = my_line_color) %>%
  gf_point(0.75 ~ 2.73, 
           size = f * 1.5 * my_line_size,
           color = my_line_color) %>%
  gf_point(0.75 ~ 6.73, 
           size = f * 1.5 * my_line_size,
           color = my_line_color) %>%
  gf_segment(-0.75 + 0.72 ~ 1.6 + 2.70, 
             arrow = arrow(length = unit(0.4, "cm"))) %>%
  gf_segment(-0.75 + 0.72 ~ 1.6 + 6.70, 
             arrow = arrow(length = unit(0.4, "cm"))) %>%
  gf_segment(-0.75 + 0.72 ~ 1.6 + 0.35, 
              arrow = arrow(length = unit(0.4, "cm"))) %>%
  gf_label(-0.75 ~ 1.6, 
           label = "f(c)=s", 
           size = f * my_font_size) %>%
  gf_text(0.75 ~ -1.5, 
          label = "s", 
          nudge_y = 0.15, 
          size = f * my_font_size, 
          color = my_constant_line_color) %>%
  gf_refine(scale_y_continuous(breaks = c()),
            scale_x_continuous(breaks = c())) %>%
  gf_theme(theme_bw(base_size = f*my_base_size)) 
```
:::
::::::

## Steigungen von Funktionen

### Sekante

Für eine Funktion von $D\subseteq \mathbf{R}$ nach $Z \subseteq \mathbf{R}$, 
$f:D \to Z$, seine die Stelen $a, b \in D$ mit $a<b$ gegeben.
Es gibt dann zu den Punkten $P(a; f(a))$ und $Q(b; f(b))$ immer eine Gerade
$g(x) = g_{PQ}(x)=m_s \cdot x + b_s$, welche die beiden Punkte $P$ und $Q$ 
miteinander verbindet.

Sollte für alle $c \in (a, b)$ die Punkte $S_c(c, f(c))$ nicht auf der Geraden
liegen, so nennen wir $g(x)$ eine **Sekante** (durch $P$ und $Q$ an $f$).


```{r echo=FALSE, out.height="40%"}
# f <- 0.4

my_fkt = makeFun(cos(0.6*(x+2))  ~ x)

gf_function( fun = my_fkt, 
             size = ~ I(f * my_line_size),
             color = ~ I(my_line_color),
             xlim = c(-1, 6)) %>%
  gf_hline(color = my_zero_line_color, 
           yintercept = ~ 0, 
           size = f * 0.25 * my_line_size,
           show.legend = FALSE) %>%
  gf_abline(slope = ((my_fkt(5) - my_fkt(0)) / (5 - 0)), 
            intercept = my_fkt(0),
            size = f * 0.75 * my_line_size,
            color = my_secant_color) %>%
  gf_point(my_fkt(0) ~ 0, 
           size = f * 1.5 * my_line_size,
           color = my_line_color) %>%
  gf_label(my_fkt(-1) ~ -1, 
           label = "f(x)", 
           size = f*my_font_size, 
           nudge_x = 0.3) %>%
  gf_text(my_fkt(0) ~ 0, 
          label = "P(a;f(a))", 
          size = f*my_font_size, 
          angle = 0, 
          hjust = 0, 
          nudge_x = 0.1, 
          nudge_y = 0.1) %>%
  gf_point(my_fkt(5) ~ 5, 
           size = f * 1.5 * my_line_size,
           color = my_line_color) %>%
  gf_text(my_fkt(5) ~ 5, 
          label = "Q(b;f(b))", 
          size = f*my_font_size, 
          angle = 0, hjust = 0, 
          nudge_x = 0.1, 
          nudge_y = -0.1) %>%
  gf_label(0.5 ~-1, 
           label = "g(x)", 
           size = f*my_font_size) %>%
  gf_refine(scale_x_continuous(breaks = seq(-1,6,1))) %>%
  gf_theme(theme_bw(base_size = f*my_base_size)) 
```


### Sekantensteigung / Differenzenquotient

Sei $f: D\subseteq \mathbf{R} \to Z \subseteq \mathbf{R}$ eine Funktion $s(x)$ 
die Sekante gegeben durch die Stützstellen $x_0 < x_1$ aus $D$ und somit eine
Gerade durch die Punkte $P(x_0; f(x_0))$ und 
$Q(x_1; f(x_1))$. Der Wert

$$m_s = \frac{f(x_1)- f(x_0)}{x_1-x_0}$$

heißt dann **Sekantensteigung** oder **Durchschnittssteigung** bzw.
**Differenzenquotient** von $f$ im Intervall $[x_0, x_1] \subseteq Z$.


Die Sekante $s(x)$ wird dann durch den folgenden Funktionsterm beschrieben:

$$s(x) = m_s \cdot x + b_s$$
Dabei ist:

$$b_s = f(x_0) - m_s \cdot x_0 = f(x_1) - m_s \cdot x_1$$


### Übung `r nextExercise()`: {.exercise} 

Bestimmen Sie jeweils die Sekante und die Sekantensteigung für die 
angegebenen Funktionen $f$ an den Stellen $x_0$ und $x_1$.

a) $f(x) = x^2$, $x_0=0$, $x_1=4$

b) $f(x) = x^2$, $x_0=2$, $x_1=4$

c) $f(x) = x^3-3x+1$, $x_0=-1$, $x_1=1$

d) $f(x) = x^3-3x+1$, $x_0=0$, $x_1=2$

e) $f(x) = x^3-3x+1$, $x_0=1$, $x_1=2$


**Zusatzaufgabe:** Skizzieren Sie für jede Teilaufgabe die Funktion und Sekante 
in einem Diagramm. 

Alternativ schauen Sie sich jeweils die Graphen mit Hilfe eines "Plotprogramms" an.
Z.B.: https://www.mathe-fa.de/de 


::: {.notes}
```{r, echo=FALSE, eval=FALSE}
# b)
fkt <- makeFun(x**2 ~ x)
x0 <- 2
x1 <- 4
f1 <- 4
f2 <- 17
# c)
fkt <- makeFun(x**3 - 3*x +1 ~ x)
x0 <- -1
x1 <- 1
f1 <- 4
f2 <- 5
# d)
fkt <- makeFun(x**3 - 3*x +1 ~ x)
x0 <- 0
x1 <- 2
f1 <- 4
f2 <- 1
# e)
fkt <- makeFun(x**3 - 3*x +1 ~ x)
x0 <- 1
x1 <- 2
f1 <- 4
f2 <- 13
(z_s <- (fkt(x0) - fkt(x1))) * f1
(n_s <- x0 - y1) * f1
(m_s <-  z_s / n_s)
(b_s <- fkt(x0) - m_s * x0) * f2
```


a) $m_s = \frac{16-0}{4-0}= 4$ und $b_s=0$. Die Sekante lautet also: $4\cdot x$

b) $m_s = -\frac{48}{17}$ und $b_s =\frac{164}{17}$. Die Sekante lautet also: $-\frac{48}{17} \cdot x + \frac{164}{17}$

c) $m_s = \frac{16}{5}$ und $b_s =\frac{31}{5}$. Die Sekante lautet also: $-\frac{16}{5} \cdot x + \frac{31}{5}$

d) $m_s = -\frac{8}{9}$ und $b_s =1$. Die Sekante lautet also: $-\frac{8}{9} \cdot x + 1$

e) $m_s = -\frac{16}{13}$ und $b_s =\frac{3}{13}$. Die Sekante lautet also: $-\frac{16}{13} \cdot x + \frac{3}{13}$

:::

### Die $\Delta$-Notation
Oft interessiert uns primär die Stelle $x_0$ und $x_1$ ist nur "in der Nähe von $x_0$".

Daher schreiben wir statt $x_1 - x_0$ wir zur Abkürzeung $\Delta x_0$, in dem wir festlegen:

$$x_1 = x_0 + \Delta x_0 \quad \Longleftrightarrow \quad \Delta x_0 = x_1 - x_0$$

Analog wollen wir statt $f(x_1) - f(x_0)$ kurz $\Delta f(x_0)$ schreiben, in dem wir festlegen:

$$\Delta f(x_0) = f(x_0 + \Delta x_0)- f(x_0) = f(x_1) - f(x_0)$$

Damit lässt sich der *Differenzenquotient* wie folgt zusammenfassen:

$$m_s = \frac{f(x_1)- f(x_0)}{x_1-x_0} = \frac{\Delta f(x_0)}{\Delta x_0}$$


### Tangentensteigung / Differenzialquotient / Ableitung

Eine (reelle) Funktion $f : D \to Z$ heißt an der Stelle $x_0 \in D$  differenzierbar, falls
der Grenzwert von

$$\lim_{\Delta x_0 \to 0} \frac{\Delta f(x_0)}{\Delta x_0} = \lim_{h \to 0} \frac{f(x_0+h)- f(x_0)}{h}$$

existiert. 

Wir nennen den Grenzwert **erste Ableitung** oder **Differenzialquotient** von $f$ an der Stelle $x_0$ und bezeichnen diesen mit:
$$f'(x_0) := \frac{d f(x_0)}{d x_0} := \lim_{\Delta x_0 \to 0} \frac{\Delta f(x_0)}{\Delta x_0} $$

Die erste Ableitung $f'(x_0)$ ist gleich der **Tangentensteigung** in dem Punkt $(x_0, f(x_0))$. 
Somit die Steigung der Geraden $t(x) = m_t \cdot x + b_t$, welche die Funktion 
$f$ im Punkt $(x_0, f(x_0))$ berührt und in diesem Punkt die selbe Steigung 
wie $f$ hat. 

Es gilt somit: 
$$m_t = f'(x_0) \quad\text{ und }\quad b_t = f(x_0) - m_t \cdot x_0.$$ 


### Näherungseigenschaften der Tangente

:::::: {.columns}
::: {.column width="60%"}

Durch eine leichte Umformung erhalten wir aus der Tangenten

$$t(x) = m_t \cdot x + b_t$$

für die Funktion $f$ an der Stelle $x_0$ die Gestalt:

$$t(x) = f(x_0) + f'(x_0) \cdot(x- x_0)$$

:::
::: {.column width="40%"}

```{r echo=FALSE, out.width="95%"}
# f <- 0.4*0.95

xrange <- c(1, 3)  # war -0.5, 3

x0 <- 2

fkt <- makeFun(x**3-3*x+3 ~ x)
dfkt <- makeFun(3*x**2-3 ~ x)
tfkt <- makeFun(fkt(x0)+ dfkt(x0) * (x - x0) ~ x)


gf_fun(fkt(x) ~ x, 
       color = ~ I(my_line_color),
       size = ~ I(f * my_line_size),
       xlim = xrange) %>%
  gf_fun(tfkt(x) ~ x,
       size = ~ I(f * my_line_size),
         color = ~ I(my_secant_color)) %>%
  gf_label(fkt(1) ~ 1, 
           label = "f(x)", 
           size = f * my_font_size) %>%
  gf_label(tfkt(1) ~ 1, 
           label = "t(x)", 
           size = f * my_font_size) %>%
  gf_labs(x = "x", y = "y") %>%
  gf_theme(theme_bw(base_size = f * my_base_size))
```
:::

::::::

Die Tangente $t(x)$ ist dann die *beste lineare Näherung* 
(oder auch *beste lineare Approximation*) der Funktion $f$ an 
der Stelle $x_0$!

Es ist somit für $x \approx x_0$:

$$f(x) \approx t(x) = f(x_0) + f'(x_0) \cdot(x- x_0)$$


## Ableitungsregeln


### Ableitung elementarer Funktionen

Für die folgenden *elementaren Funktionen* kann man explizite Ableitungsregeln angeben.

Sei $f: D \to Z$ eine Funktion und $a>0$, $b$, $c$ reelle Zahlen. Dann gilt:

:::::: {.columns}
::: {.column width="49%"}

+------------+--------------------+
| $f(x)$     | $f'(x)$            | 
+:===========+:===================+
| $x^b$      | $b\cdot x^{b-1}$   |
+------------+--------------------+
| $e^x$      | $e^x$              |
+------------+--------------------+
| $\ln(x)$   | $\frac{1}{x}$      |
+------------+--------------------+

:::
::: {.column width="49%"}

+-------------+----------------------------+
| $f(x)$      | $f'(x)$                    | 
+=============+:===========================+
| $c$         | $0$                        |
+-------------+----------------------------+
| $\log_a(x)$ | $\frac{1}{x \cdot \ln(a)}$ |
+-------------+----------------------------+
| $a^x$       | $a^x \cdot \ln(a)$         |
+-------------+----------------------------+

:::
::::::


### Übung `r nextExercise()`: {.exercise} 

<!-- Übung von Ross/Christians -->

Bestimmen Sie für die folgenden Funktionen $f(x)$, die Ableitungen $f'(x)$ und
werten Sie dann die Funktion $f'(x)$ an der Stelle $x_0$ aus.

+------+-----------------+------------------+------------------+------------------+
|      | $f(x)$          | $x_0$            | $f'(x)$          | $f'(x_0)$        |
+:====:+:================+:=================+:=================+:=================+
| a$)$ | $x^4$           | $0{,}5$          | $\qquad \qquad$  | $\qquad \qquad$  |
+------+-----------------+------------------+------------------+------------------+
| b$)$ | $3$             | $-4$             | $\qquad \qquad$  | $\qquad \qquad$  |
+------+-----------------+------------------+------------------+------------------+
| c$)$ | $x$             | $-4$             | $\qquad \qquad$  | $\qquad \qquad$  |
+------+-----------------+------------------+------------------+------------------+
| d$)$ | $x^{0{,}5}$     | $4$              | $\qquad \qquad$  | $\qquad \qquad$  |
+------+-----------------+------------------+------------------+------------------+
| e$)$ | $x^{-1{,}5}$    | $4$              | $\qquad \qquad$  | $\qquad \qquad$  |
+------+-----------------+------------------+------------------+------------------+
| f$)$ | $3^x$           | $0$              | $\qquad \qquad$  | $\qquad \qquad$  |
+------+-----------------+------------------+------------------+------------------+


::: {.notes}

+------+-----------------+------------------+--------------------------+------------------+
|      | $f(x)$          | $x_0$            | $f'(x)$                  | $f'(x_0)$        |
+:====:+:================+:=================+:=========================+:=================+
| a$)$ | $x^4$           | $0{,}5$          | $4x^3$                   | $0{,}5$          |
+------+-----------------+------------------+--------------------------+------------------+
| b$)$ | $3$             | $-4$             | $0$                      | $0$              |
+------+-----------------+------------------+--------------------------+------------------+
| c$)$ | $x$             | $-4$             | $1$                      | $1$              |
+------+-----------------+------------------+--------------------------+------------------+
| d$)$ | $x^{0{,}5}$     | $4$              | $0{,}5 \cdot x^{-0{,}5}$ | $0{,}25$         |
+------+-----------------+------------------+--------------------------+------------------+
| e$)$ | $x^{-1{,}5}$    | $4$              | $-1{,}5\cdot x^{-2{,}5}$ | $\frac{-3}{64}$  |
+------+-----------------+------------------+--------------------------+------------------+
| f$)$ | $3^x$           | $0$              | $3^x \cdot \ln(3)$       | $\ln(3)$         |
+------+-----------------+------------------+--------------------------+------------------+

:::

<!-- -->

### Summenregel

Sei $f(x) = g(x) + h(x)$, dann gilt für die Ableitung gemäß **Summenregel**:

$$f'(x) = g'(x)+h'(x)$$

**Beispiele:**

- $\left(x^3+x^2\right)' = 3x^2+2x$

- $\left(x+1\right)' = 1+0 = 1$

- $\left(x^2+\ln(x)\right)' = 2x+\frac{1}{x}$

- $\left(e^x+\ln(x)\right)' = e^x+\frac{1}{x}$

- $\left(4^x+x^4\right)' = 4^x\cdot\ln(4) + 4x^3$

- $\left(\log_3(x)+x^{-2}\right)' = (x \ln(3))^{-1}-2x^{-3} = \frac{1}{x \cdot \ln(3)} - \frac{2}{x^3}$

<!-- -->

### Produktregel

Sei $f(x) = g(x) \cdot h(x)$, dann gilt für die Ableitung gemäß Produktregel:

$$f'(x) = g'(x) \cdot h(x) + g(x) \cdot h'(x)$$

**Sonderfall:** *Produktregel mit Konstanter (Funktion)* / **Faktorregel**

Sei $f(x) = c \cdot g(x)$, dann ist $f'(x)= c \cdot g'(x)$.

**Beispiele:**

::: {.scriptsize}

- $\displaystyle \left(x^2 \cdot x\right)' = 2x\cdot x + x^2 \cdot 1 = 3x^2$

- $\displaystyle \left(\ln(x) \cdot x\right)' = x^{-1} \cdot x + \ln(x) \cdot 1 = 1+ \ln(x)$

- $\displaystyle \left(\sqrt{x} \cdot e^x\right)' = \left(x^{0{,}5} \cdot e^x\right)' = 0{,}5x^{-0{,}5} \cdot e^x + x^{0{,}5} \cdot e^x = \frac{(0{,}5+x)\cdot e^x}{\sqrt{x}}$

- $\displaystyle \left(4 \cdot x\right)' = 0 \cdot x + 4 \cdot 1 = 4$

- $\displaystyle \left(10 \cdot x^2\right)' = 10 \cdot \left( x^2\right)' = 10 \cdot 2 \cdot x = 20 x$

- $\displaystyle \left(5  \cdot \ln(x) \cdot x\right)' = 5  \cdot \left(\ln(x) \cdot x\right)' = 5 \cdot (1+ \ln(x)) = 5+5\ln(x)$

- $\displaystyle \left(\frac{5}{x}\right)' = 5 \cdot \left(\frac{1}{x}\right)' = 5 \cdot \left(x^{-1}\right)' = 5 \cdot (-1)\cdot x^{-2} =-\frac{5}{x^2}$

:::

<!-- -->


### Übung  `r nextExercise()`: {.exercise} 

Bestimmen Sie die ersten Ableitungen der folgenden Funktionen

:::::: {.columns}
::: {.column width="49%"}

a) $\displaystyle 4x^3+6x^2$

b) $\displaystyle 10e^x+4x^{2{,}5}$

c) $\displaystyle 2x^{-1}+\ln(x)$

d) $\displaystyle 2\sqrt{x}$

e) $\displaystyle 2\sqrt{x} \cdot e^x$

f) $\displaystyle e^{2+x}$

g) $\displaystyle (x+2)x$

h) $\displaystyle \left(x^2+x^3\right)e^x$

:::
::: {.column width="49%"}

i) $\displaystyle 4x^3 \ln(x)$

j) $\displaystyle 4^x \ln(x)$

k) $\displaystyle \log_2(x) \ln(x)$

l) $\displaystyle x^2\sqrt{x}$

m) $\displaystyle e^x \cdot e^x$

n) $\displaystyle x^2e^x\ln(x)$

o) $\displaystyle \ln(x)\sqrt{x}$

p) $\displaystyle 5e^xx^{-2}$

:::
::::::

### Quotientenregel

Sei $\displaystyle f(x) = \frac{g(x)}{h(x)}$, dann gilt für die Ableitung gemäß **Quotientenregel**:

$$f'(x) = \left(\frac{g(x)}{h(x)}\right)' = \frac{g'(x)\cdot h(x)- g(x) \cdot h'(x)}{\left(h(x)\right)^2}$$

**Beispiele:**

- $\displaystyle \left(\frac{x^3}{x^2}\right)' = \frac{3x^2\cdot x^2- x^3\cdot 2x}{(x^2)^2} = \frac{3x^4- 2x^4}{x^{2\cdot 2}} = \frac{x^4}{x^4} = 1$


- $\displaystyle \left(\frac{\ln(x)}{x^2}\right)' = \frac{\frac{1}{x} \cdot x^2- \ln(x) \cdot 2x}{x^4} = \frac{1-2 \ln(x)}{x^3}$

- $\displaystyle \left(\frac{e^x}{\sqrt{x}}\right)' =\frac{e^x \cdot \sqrt{x}- 0{,}5\cdot e^x \cdot x^{-0{,}5}}{(\sqrt{x})^2} = \frac{e^x \cdot(\sqrt{x}-\frac{1}{2\sqrt{x}})}{x} = \frac{e^x \cdot(\frac{2x}{2\sqrt{x}}-\frac{1}{2\sqrt{x}})}{x}$
    
    $\displaystyle \phantom{\left(\frac{e^x}{\sqrt{x}}\right)'} = \frac{e^x \cdot(2x-1)}{2x\sqrt{x}}$
<!-- -->

### Kettenregel

Sei $\displaystyle f(x) = g\left(h(x)\right)$, dann gilt für die Ableitung gemäß Kettenregel:

$$f'(x) = \left(g\left(h(x)\right)\right)' = g'(h(x)) \cdot h'(x)$$

**Beispiele:**

- $\displaystyle \left(\left(2x\right)^3\right)' = 3 \cdot \left(2x^2\right) \cdot 2 = 24 x^2$

- $\displaystyle \left(\ln\left(x^2\right)\right)' = \frac{1}{x^2} \cdot 2x = \frac{2}{x}$

- $\displaystyle \left(e^{2x^2}\right)' = e^{2x^2} \cdot 4x$

- $\displaystyle \left(\left(3x^2+4x\right)^3\right)' = 3 \cdot \left(3x^2+4x\right)^2 \cdot (6x+4)$

<!-- -->


### Übungen {include-only=LangeFassung}


<!-- -->


### Übung `r nextExercise()`: {.exercise} 

Bestimmen Sie die ersten Ableitungen der folgenden Funktionen:

:::::: {.columns}
::: {.column width="49%"}

a) $\displaystyle \ln(4x+1)$

b) $\displaystyle \ln(2x^{-2})$

c) $\displaystyle \frac{0{,}5x+1}{x^{-1}}$

d) $\displaystyle \ln\left(\sqrt[3]{x}\right)$

e) $\displaystyle \sqrt[4]{\frac{16x^{101}}{\sqrt[2]{x^2}}}$

f) $\displaystyle \sqrt{e^{(x^4)}}$

:::
::: {.column width="49%"}

g) $\displaystyle \frac{4x^3+6x^2}{\ln(x)}$

h) $\displaystyle \frac{10e^x+4x^{2{,}5}}{\sqrt{x}}$

i) $\displaystyle \frac{2x^{-0{,}5}}{e^x}$

j) $\displaystyle \sqrt[4]{4x^2-1}$

k) $\displaystyle \frac{x^2+x^3}{e^{-x}}$

:::
::::::
<!-- -->


## Extremstellen von Funktionen

### Monotonie

Eine Funktion deren Werte die auf einem Intervall $I$ nicht abnehmen heißt
**monoton steigend** und es gilt:
$$x < y \Longrightarrow f(x) \leq f(y) \quad \forall x,y \in I$$
Umgekehrt, nehmen die Werte auf einem Intervall $I$ nicht zu, dann heißt die
Funktion **monoton fallend** und es gilt:

$$x < y \Longrightarrow f(x) \geq f(y) \quad \forall x,y \in I$$
Gilt in beiden Fällen jeweils auf der rechten Seite die *strikte Ungleichung* 
($<$ bzw. $>$), so nennen wir die Funktionen auch **streng** *monoton* 
*steigend* bzw. *fallend*.

**Monotonie** setzt voraus, dass die *Steigungen* im jeweiligen Intervall $I$
*nicht negativ* (im *strengen* Fall *positiv*) bzw. 
*nicht positiv* (im strengen Fall *negativ*) sind.

Für auf $I$ differenzierbare Funktionen gilt daher:

- $f$ ist auf $I$ *(streng) monoton steigend* 
  $\Longleftrightarrow f'(x) \geq (>) 0$
- $f$ ist auf $I$ *(streng) monoton fallend* 
  $\Longleftrightarrow f'(x) \leq (<) 0$


### Krümmung

Eine reellwertige Funktion heißt **konvex** auf dem Intervall $I$, wenn
für je zwei Stellen $a < b$ mit $a, b \in I$ die Funktionswerte von $f$ unterhalb
der Verbindungsstrecke von $(a; f(a))$ und $(b; f(b))$ liegt.
Liegen alle Funktionswerte oberhalb, so nennen wir die Funktion **konkav** auf 
$I$:

Es gilt dann:

:::::: {.columns}
::: {.column width="60%"}

- $f$ ist **konvex** auf $I$ $\Longleftrightarrow$ 
    $\forall t \in [0,1], x, y \in I:$ 
$$f(t \cdot x + (1-t) \cdot y) \leq t\cdot f(x) + (1-t)\cdot f(y)$$

:::
::: {.column width="39%"}

**Beispiel:**
```{r echo=FALSE, out.width="65%"}
# f <- 0.65
fkt <- makeFun(x^2 ~ x)
x0 <- -1.5
y0 <- fkt(x0)
x1 <- 1
y1 <- fkt(x1)

# m <- (y1 - y0) / (x1 - x0)
# b <- y1 - m*x1

gf_fun(fkt(x) ~ x, 
       size = ~ I(f*my_line_size),
       color = ~ I(my_line_color),
       xlim = c(-2,2)) %>%
  gf_line(c(y1,y0) ~ c(x1,x0),
          size = ~ I(f*0.75*my_line_size),
          color = ~ I(my_secant_color),) %>%
  gf_theme(theme_bw(base_size = f * my_base_size)) 
```

:::
::::::

:::::: {.columns}
::: {.column width="60%"}

- $f$ ist **konkav** auf $I$ $\Longleftrightarrow$ 
    $\forall t \in [0,1], x, y \in I:$ 
$$f(t \cdot x + (1-t) \cdot y) \geq t\cdot f(x) + (1-t)\cdot f(y)$$

:::
::: {.column width="39%"}

**Beispiel:**

```{r echo=FALSE, out.width="65%"}
# f <- 0.65
fkt <- makeFun(-x^2 ~ x)

x0 <- -1
y0 <- fkt(x0)
x1 <- 1.5
y1 <- fkt(x1)

# m <- (y1 - y0) / (x1 - x0)
# b <- y1 - m*x1

gf_fun(fkt(x) ~ x,  
       size = ~ I(f*my_line_size),
       color = ~ I(my_line_color),
       xlim = c(-2,2)) %>%
  gf_line(c(y1,y0) ~ c(x1,x0),
          size = ~ I(f*0.75*my_line_size),
          color = ~ I(my_secant_color),) %>%
  gf_theme(theme_bw(base_size = f * my_base_size)) 
```
:::
::::::


### Zweite (und höhere) Ableitung

Falls für eine differenzierbare Funktion $f$ die Ableitungsfunktion $f'$ ebenfalls
differenzierbar ist, nennen wir diese **2. Ableitung von f** und schreiben 
dafür

$$f''(x) = \left[f'(x)\right]' = \frac{d}{dx} \left(\frac{d}{dx} f\right) = \frac{d^2}{dx^2} f$$

Rekursiv definieren wir die $n$-te Ableitung, falls die $n-1$ Ableitungsfunktion
existiert und differenzierbar ist. Wir schreiben dann:

$$f^{(0)}(x) = f(x), \quad f^{(1)}(x) = f'(x)= \frac{d}{dx} f$$
$$f^{(n)}(x) = \left[f^{(n-1)}(x)\right]' = \frac{d}{dx} \left(\frac{d^{n-1}}{dx^{n-1}} f\right) = \frac{d^n}{dx^n} f$$


### Krümmung und die 2. Ableitung / Wendepunkte

:::::: {.columns}
::: {.column width="60%"}

Die 2. Ableitung einer Funktion beschreibt ihr Krümmungsverhalten, denn es gilt:

Eine *zweimal differenzierbare* Funktion $f$ ist auf dem Intervall $I$

- **(streng)** **konvex** $\Longleftrightarrow f''(x) (>)\geq 0$
- **(streng)** **konkav** $\Longleftrightarrow f''(x) (<)\leq 0$

für alle $x \in I$.

:::
::: {.column width="40%"}

```{r echo=FALSE, out.width="95%"}
# f <- 0.4*0.95

xlabel = -3.4
xrange <- c(-3.5, 3)  
fkt <- makeFun(x**3-3*x+3 ~ x)
dfkt <- makeFun(3*x**2-3 ~ x)
ddfkt <- makeFun(6*x ~ x)
tfkt <- makeFun(fkt(x0)+ dfkt(x0) * (x - x0) ~ x)

gf_fun(fkt(x) ~ x, 
       color = ~ I(my_line_color),
       size = ~ I(f * my_line_size),
       xlim = xrange) %>%
  gf_fun(ddfkt(x) ~ x,
       size = ~ I(f * 0.75 * my_line_size),
         color = ~ I(my_secant_color)) %>%
  gf_hline(yintercept = 0, 
           color = my_zero_line_color) %>%
  gf_vline(xintercept = 0,
           color = my_zero_line_color,
           linetype = "dotted") %>%
  gf_label(fkt(xlabel) ~ xlabel,
           label = "f(x)",
           color = my_line_color,
           size = f * 0.75 * my_font_size) %>%
  gf_label(ddfkt(xlabel) ~ xlabel,
           label = "f''(x)",
           color = my_secant_color,
           size = f * 0.75 * my_font_size) %>%
  gf_text(20 ~ -2, 
          label = "konkaver Bereich",
           size = f * 0.75 * my_font_size) %>%
  gf_text(-20 ~ 2, 
          label = "konvexer Bereich",
           size = f * 0.75 * my_font_size) %>%
  gf_point(fkt(0) ~ 0,,
           color = my_line_color,
           size = f * 1.5 * my_line_size) %>%
  gf_label(I(fkt(0)+5) ~ 0,
           label = "Wendepunkt",
           size = f * 0.75 * my_font_size) %>%
  gf_labs(x = "x", y = "y") %>%
  gf_theme(theme_bw(base_size = f * my_base_size))
```


:::
::::::

Der Punkt, an dem eine Funktion von einem konvexen Bereich in einen konkaven 
Bereich bzw. von einem konkaven in einen konvexen Bereich übergeht bezeichnen 
wir als **Wendepunkt**. 

Daher ist eine notwendige Bedingung für eine *Wendestelle* $x_{WP}$, dass 
$f''(x_{WP})=0$ gilt. Der *Wendepunkt* ist dann $(x_{WP}, f(x_{WP}))$.


### Globale und lokale Extremstellen

Für eine univariate, reellwertige Funktion $f: D \to Z$ und $x_0 \in D$ gilt:
$x_0$ heißt

- **globales Maximum**, falls $f(x) \leq f(x_0)$ für alle $x\in D$ gilt

- **strenges globales Maximum**, falls $f(x) < f(x_0)$ für alle $x \in D \setminus \{x_0\}$ gilt.

- **lokales Maximum**, falls $f(x) \leq f(x_0)$ für alle $x$ in einer echten Umgebung von $x_0$ gilt

- **strenges lokales Maximum**, falls $f(x) < f(x_0)$ für alle $x$ in einer echten Umgebung von $x_0$ gilt.

Analog die Definition mit **Minimum**. 


### Übung `r nextExercise()`: {.exercise} 

Schreiben Sie die Definitionen von 
**globales Minimum**, 
**strenges globales Minimum**, 
**lokales Minimum** und **strenges lokales Minimum** explizit auf!

::: {.notes}
Für eine univariate, reellwertige Funktion $f: D \to Z$ und $x_0 \in D$ gilt:
$x_0$ heißt

- **globales Minimum**, falls $f(x) \geq f(x_0)$ für alle $x\in D$ gilt

- **strenges globales Minimum**, falls $f(x) > f(x_0)$ für alle $x \in D \setminus \{x_0\}$ gilt.

- **lokales Minimum**, falls $f(x) \geq f(x_0)$ für alle $x$ in einer echten Umgebung von $x_0$ gilt

- **strenges lokales Minimum**, falls $f(x) > f(x_0)$ für alle $x$ in einer echten Umgebung von $x_0$ gilt.

:::


<!-- -->

### Beispiel

$f(x) = x^3-9x^2$, $\;f'(x)=3x^2-18x$, $\;f''(x)=6x-18$

```{r warnings=FALSE, echo=FALSE, fig.align="center", out.width="70%", }
# f <- 0.7
myFun <- function(x) {
    x**3 - 9*x**2
}

myDFun <- function(x) {
    3*x**2 - 18 * x
}

myDDFun <- function(x) {
    6*x - 18
}

my.df <- data.frame(x = c(-10.5,10.5))
my.df.text <- data.frame(
    x = c(0,6,3),
    y = c(myFun(0), myFun(6), myFun(3)),
    text = c("lok. Maximum", "lok. Minimum", "Wendepunkt")
)

ggplot(my.df, aes(x = x)) +
    geom_vline(aes(xintercept = 0)) +
    geom_hline(aes(yintercept = 0)) +
    stat_function(fun = myFun, n = 1000, size = 1.25,
                  aes(colour = "f(x)")) +
    stat_function(fun = myDFun, n = 1000,
                  aes(colour = "f'(x)")) +
    stat_function(fun = myDDFun, n = 1000,
                  aes(colour = "f''(x)")) +
    geom_vline(aes(xintercept = 3), linetype = "dashed", size = 0.5, color = "orange") +
    geom_vline(aes(xintercept = 0), linetype = "dashed", size = 0.5, color = "orange") +
    geom_vline(aes(xintercept = 6), linetype = "dashed", size = 0.5, color = "orange") +
    geom_point(data = my.df.text,
               aes(x = x, y = y),
               size = 2,
               color = "red") +
    geom_label(data = my.df.text,
               aes(x = x, y = y, label = text),
               hjust = 0, 
               vjust = 0,
               nudge_x = 0.3,
               nudge_y = 0.75
               ) + 
    coord_cartesian(xlim = c(-5,10), ylim = c(-125, 50)) 

```


### Beispiel Sattelpunkt

$f(x) = x^3-9x^2+27x$, $\;f'(x)=3x^2-18x+27$, $\;f''(x)=6x-18$

```{r warnings=FALSE, echo=FALSE, fig.align="center", out.width="70%", }
#f <- 0.7

myFun <- function(x) {
    x**3 - 9*x**2 + 27*x
}

myDFun <- function(x) {
    3*x**2 - 18 * x + 27
}

myDDFun <- function(x) {
    6*x - 18
}

my.df <- data.frame(x = c(-2.5,8.5))
my.df.text <- data.frame(
    x = c(3),
    y = c(myFun(3)),
    text = c("Sattelpunkt")
)

ggplot(my.df, aes(x = x)) +
    geom_vline(aes(xintercept = 0)) +
    geom_hline(aes(yintercept = 0)) +
    stat_function(fun = myFun, n = 1000, size = 1.25,
                  aes(colour = "f(x)")) +
    stat_function(fun = myDFun, n = 1000,
                  aes(colour = "f'(x)")) +
    stat_function(fun = myDDFun, n = 1000,
                  aes(colour = "f''(x)")) +
    geom_vline(aes(xintercept = 3), linetype = "dashed", size = 0.5, color = "orange") +
    geom_point(data = my.df.text,
               aes(x = x, y = y),
               size = 2,
               color = "red") +
    geom_label(data = my.df.text,
               aes(x = x, y = y, label = text),
               hjust = 0, 
               vjust = 0,
               nudge_x = 0.3,
               nudge_y = 0.75
               ) + 
    coord_cartesian(xlim = c(-2, 7), ylim = c(-30, 60)) +
    scale_y_continuous(breaks = seq(-30,60,15)) +
    scale_x_continuous(breaks = seq(-2,7,1))

```


### Beispiel

Wir analysieren die Funktion $f(x) = x^3-3x^2-24x+2$.

Bestimmen Sie die Nullstellen der ersten und zweiten Ableitung von $f$.

Überprüfen Sie, ob es sich bei diesen Nullstellen um Maxima, Minima, Wende- 
oder Sattelpunkte handelt.

**Lösung:**

$f(x)=x^3-3x^2-24x+2$, $\;f'(x)=3x^2-6x-24$, $\;f''(x)=6x-6$, $f'''(x)=6$

$f'(x)=0 \Leftrightarrow 3x^2-6x-24 = 0\Leftrightarrow x=-2 \vee x=4$

$f''(-2) = -18 < 0$, also ist bei $x_{max} = -2; y_{max} = 30$ ein lokales Maximum.

$f''(4) = 18 > 0$, also ist bei $x_{min}=4;\, y_{min} = -78$ ein lokales Minimum.

Wegen $f''(x) = 0 \Leftrightarrow x=1$ und $f'''(1)=6 \neq 0$ gibt es bei
$x_{WP}=1$ einen Wendepunkt bei $WP(1; -24)$. 

Wegen $f'(1)=-27 \neq 0$ gibt es an der Stelle $x=1$ *keinen* Sattelpunkt.


### Übung `r nextExercise()`: {.exercise} 

<!-- Übung von Ross/Christiaans -->

Bestimmen Sie bei den folgenden Funktionen die Maxima, Minima, Wende- und 
Sattelpunkte.

a) $\displaystyle f(x) = x^2 + 4x +10$

b) $\displaystyle f(x) = -2x^2 + 16x +12$

c) $\displaystyle f(x) = 2x^3 - 12x^2 + 18x +1$

d) $\displaystyle f(x) = -x(3-x)^2+2$

e) $\displaystyle f(x) = 2x^3-6x^2-48x+4$

f) $\displaystyle f(x) = 2x^3-18x^2+54x+1$

g) $\displaystyle f(x) = x^3-6x^2+12x-8$

h) $\displaystyle f(x) = -2x^3 + 24x$

i) $\displaystyle f(x) = -2x^3 + 6x^2$


### Übung `r nextExercise()`: {.exercise} 

<!-- Übung von Ross/Christiaans -->

Bestimmen Sie bei den folgenden Funktionen die Maxima, Minima, Wende- und 
Sattelpunkte.

a) $\displaystyle f(x) = -x^2$

b) $\displaystyle f(x) = x^2-x-1$

c) $\displaystyle f(x) = 0{,}\overline{3}x^3-4x$

d) $\displaystyle f(x) = \ln(x)-x$

e) $\displaystyle f(x) = \sqrt{x}-x\quad (\text{für }x>0)$

f) $\displaystyle f(x) = e^{\left(x^2\right)}$

g) $\displaystyle f(x) = xe^{-x}$

h) $\displaystyle f(x) = e^x$

i) $\displaystyle f(x) = x^{-1{,}5}+1{,}5x\quad (\text{für }x>0)$


### Beispiel: Gewinnmaximum und Break Even mit Konkurrenz

Betrachten Sie ein Unternehmen, welches sich einem konstanten Marktpreis 
$p = 10$ gegenübersieht. 
Die Kosten sind abhängig von der produzierten Menge $x$ und gegeben durch 
$K(x) = 0{,}64x^2 -6x + 64$.

:::::: {.columns}
::: {.column width="49%"}

**Erlöse:** 

$E(x)= p \cdot x = 10x$

**Gewinnfunktion:** 

$G(x)=E(x)-K(x)$ 

$\phantom{G(x)}= 10x - (0{,}64x^2 -6x + 64)$  

$\phantom{G(x)}= -0{,}64x^2 + 16x -64$ 

**Gewinnmaximum:** 

$G'(x)=0 \Leftrightarrow -1{,}28x+16 = 0$

$\phantom{G`(x)=0}\Leftrightarrow x_{max} = 12{,}5$

**Gewinne im Maximum:** 

$G_{max} = G(x_{max}) = 36$

:::
::: {.column width="49%"}

```{r echo=FALSE, out.width="95%"}
# f <- 0.50
my_P = makeFun(10 ~ x)
my_E = makeFun(my_P(x) * x  ~ x)
my_K = makeFun((0.64*x -6) * x + 64 ~ x)
my_G = makeFun(my_E(x) - my_K(x) ~ x) 
my_DK = makeFun(my_K(x) / x ~ x)

gf_function( fun = my_G, color = "green", xlim = c(0, 20.5)) %>%
  gf_function( fun = my_E, color = ~I(my_line_color), xlim = c(0, 20.5)) %>%
  gf_function( fun = my_K, color = "red", xlim = c(0, 20.5)) %>%
  gf_point(36 ~ 12.5, color = "green", size = 2) %>%
  gf_point(89 ~ 12.5, color = "red", size = 2) %>%
  gf_point(125 ~ 12.5, color = my_line_color, size = 2) %>%
  gf_point(c(0,0) ~ c(5,20), color = "green", size = 2) %>%
  gf_point(50 ~ 5, color = "red", fill = "blue", size = 2) %>%
  gf_point(200 ~ 20, color = "red", fill = "blue", size = 2) %>%
  gf_path(c(0,50) ~ c(5,5) , linetype = "dotted", color = "darkgray") %>%
  gf_path(c(0,125) ~ c(12.5,12.5) , linetype = "dotted", color = "darkgray") %>%
  gf_path(c(0,200) ~ c(20,20) , linetype = "dotted", color = "darkgray") %>%
  gf_label(10 ~ 1.5, label = "E(x)", size = f * my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>% 
  gf_label(my_K(1.5) ~ 1.5, label = "K(x)", size = f * my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>% 
  gf_label(my_G(1.5) ~ 1.5, label = "G(x)", size = f * my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>% 
  gf_label((my_G(12.5) + 15) ~ 12.5, label = "max. Gewinn", size = f * my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>%
  gf_label(-15 ~ 5.6, label = "Break Even Point", size = f * my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>%
  gf_refine(scale_x_continuous(breaks = seq(0,20,2.5)),
            scale_y_continuous(breaks = c(0,36,my_K(5),my_K(12.5), my_E(12.5),my_K(20)))) %>%
  gf_hline(yintercept = 0, color = my_zero_line_color) %>%
  gf_theme(theme_bw(base_size = f * my_base_size)) 
```

:::
::::::

**Break Even (BE):** $G(x) = 0 \Leftrightarrow -0{,}64x^2 + 16x + -64 = 0$
$x_{BE} = x_1 = 5$, $x_2 = 20$ (*obere Gewinngrenze*)




### Beispiel: Gewinnmaximum und Break Even mit Konkurrenz (Fortset.)


**Betriebsoptimum:** (Minimum der Durchschnittskosten)
$DK(x) = \frac{K(x)}{x} = \frac{0{,}64x^2 -6x + 64}{x} = 0{,}64x -6 + \frac{64}{x}$
$DK'(x) = 0{,}64 - \frac{64}{x^2} = 0 \Leftrightarrow x_{BO}=10 \vee x=-10$ (n.w.w.r.)

```{r echo=FALSE, out.width="70%"}
# f <- 0.7
my_P = makeFun(10 ~ x)
my_E = makeFun(my_P(x) * x  ~ x)
my_K = makeFun((0.64*x -6) * x + 64 ~ x)
my_G = makeFun(my_E(x) - my_K(x) ~ x) 
my_DK = makeFun(my_K(x) / x ~ x)
my_DE = makeFun(my_E(x) / x  ~ x)
#my_DG = makeFun(my_DE(x)-my_DK(x) ~ x)

gf_function( fun = my_DK, color = "red", xlim = c(5, 20.)) %>%
  gf_function( fun = my_G, color = ~ I(my_line_color), xlim = c(5, 20)) %>%
#  gf_function( fun = my_DE, color = "green", xlim = c(5, 20)) %>%
#  gf_function( fun = my_DG, color = "orange", xlim = c(5, 20)) %>%
  gf_point(my_DK(10) ~ 10, color = "red", size = f * 2) %>%
  gf_point(my_G(12.5) ~ 12.5, color = my_line_color, size = f * 2) %>%

  gf_refine(scale_x_continuous(breaks = seq(5,20,2.5)),
            scale_y_continuous(breaks = c(0, my_DK(10), 10, 36))) %>%
  gf_hline(yintercept = 0, color = my_zero_line_color) %>%
  gf_theme(theme_bw(base_size = f * my_base_size)) 


```



### Beispiel: Gewinnmaximum und Break Even mit Marktmacht

Betrachten Sie ein Unternehmen mit Marktmacht, welches sich der Marktnachfrage 
$p(x) = 30-x$ gegenübersieht, wobei hier $p$ den Preis und $x$ die Menge bezeichnet. 
Die Kosten sind gegeben durch $K(x) = 0{,}5x^2 +18x + 18$. 

:::::: {.columns}
::: {.column width="49%"}

**Erlöse:** 

$E(x)= p(x) \cdot x = 30x-x^2$

**Gewinnfunktion:** 

$G(x)=E(x)-K(x)$ 

$\phantom{G(x)}= 30x-x^2 - (0{,}5x^2 +18x + 18)$  

$\phantom{G(x)}= -1{,}5x^2 + 12x -18$ 

**Gewinnmaximum:** 

$G'(x)=0 \Leftrightarrow -3{,}0x+12 = 0$

$\phantom{G`(x)=0}\Leftrightarrow x_{max} = 4{,}0$

**Gewinne im Maximum:** 

$G_{max} = G(x_{max}) = 6$

**Preis im Maximum:** 

$P_{max} = p(x_{max}) = 26$


:::
::: {.column width="49%"}

```{r echo=FALSE, out.width="95%"}
#my_size = 2
#my_zero_line_color = "black"
#my_line_color = my_line_color
#my_sec_color = "green"
# f <- 0.95
my_P = makeFun(30-x ~ x)
my_E = makeFun(my_P(x) * x  ~ x)
my_K = makeFun(0.5*x*x + 18*x +18 ~ x)
my_G = makeFun(my_E(x) - my_K(x) ~ x) 
#my_DK = makeFun(my_K(x) / x ~ x)

gf_function( fun = my_G, color = "green", xlim = c(1.8, 6.2)) %>%
#  gf_function( fun = my_E, color = my_line_color, xlim = c(0, 7)) %>%
#  gf_function( fun = my_K, color = "red", xlim = c(0, 7)) %>%
  gf_point(6 ~ 4, color = "green", size = 2) %>%
#  gf_point(89 ~ 12.5, color = "red", size = 2) %>%
#  gf_point(125 ~ 12.5, color = my_line_color, size = 2) %>%
  gf_point(c(0,0) ~ c(2,6), color = "green", size = 2) %>%
#  gf_point(50 ~ 5, color = "red", fill = "blue", size = 2) %>%
#  gf_point(200 ~ 20, color = "red", fill = "blue", size = 2) %>%
  gf_path(c(0,6) ~ c(4,4) , linetype = "dotted", color = "darkgray") %>%
#  gf_path(c(0,125) ~ c(12.5,12.5) , linetype = "dotted", color = "darkgray") %>%
#  gf_path(c(0,200) ~ c(20,20) , linetype = "dotted", color = "darkgray") %>%
#  gf_label(10 ~ 1.5, label = "E(x)", size = my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>% 
#  gf_label(my_K(1.5) ~ 1.5, label = "K(x)", size = my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>% 
#  gf_label(my_G(1.5) ~ 1.5, label = "G(x)", size = my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>% 
#  gf_label((my_G(12.5) + 15) ~ 12.5, label = "max. Gewinn", size = my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>%
#  gf_label(-15 ~ 5.6, label = "Break Even Point", size = my_font_size, angle = 0, hjust = 0, nudge_x = -0.5, nudge_y = 0.5) %>%
#  gf_refine(scale_x_continuous(breaks = seq(0,20,2.5))) %>%
#  gf_refine(scale_y_continuous(breaks = c(0,36,my_K(5),my_K(12.5), my_E(12.5),my_K(20)))) %>%
  gf_hline(yintercept = 0, color = my_zero_line_color) %>%
  gf_theme(theme_bw(base_size = f*my_base_size)) 
```

:::
::::::

**Break Even (BE):** $G(x) = 0 \Leftrightarrow -1{,}5x^2 + 12x -18 = 0$
$x_{BE} = x_1 = 2$, $x_2 = 6$ (*obere Gewinngrenze*)

### Beispiel: Gewinnmaximum und Break Even mit Marktmacht (Fortset.)


**Betriebsoptimum:** (Minimum der Durchschnittskosten)
$DK(x) = \frac{K(x)}{x} = \frac{0{,}5x^2 +18x + 18}{x} = 0{,}5x + 18 + \frac{18}{x}$
$DK'(x) = 0{,}5 - \frac{18}{x^2} = 0 \Leftrightarrow x_{BO}=6 \vee x=-6$ (n.w.w.r)

```{r echo=FALSE, out.width="70%"}
# f <- 0.7
my_P = makeFun(30-x ~ x)
my_E = makeFun(my_P(x) * x  ~ x)
my_K = makeFun(0.5*x*x + 18*x +18 ~ x)
my_G = makeFun(my_E(x) - my_K(x) ~ x) 
my_DK = makeFun(my_K(x) / x ~ x)

gf_function( fun = my_DK, color = "red", xlim = c(2, 6.5)) %>%
  gf_function( fun = my_G, color = ~ I(my_line_color), xlim = c(2, 6.5)) %>%
#  gf_function( fun = my_DE, color = "green", xlim = c(5, 20)) %>%
#  gf_function( fun = my_DG, color = "orange", xlim = c(5, 20)) %>%
  gf_point(my_DK(6) ~ 6, color = "red", size = 2) %>%
  gf_point(my_G(4) ~ 4, color = my_line_color, size = 2) %>%

  gf_refine(scale_x_continuous(breaks = seq(2,6,1))) %>%
  gf_refine(scale_y_continuous(breaks = c(0, my_DK(6), my_G(4),30))) %>%
  gf_hline(yintercept = 0, color = my_zero_line_color) %>%
  gf_theme(theme_bw(base_size = my_base_size)) 


```


### Übung `r nextExercise()`: {.exercise} 

Bestimmen Sie für ein Unternehmen ohne Marktmacht, welches sich nachfolgendem 
Marktpreis $p$ und Kosten $K(x)$ gegenübersieht, die Break-Even-Menge $x_{BE}$, 
sowie für das Gewinnmaximum Menge $x_{max}$ und Gewinn $G_{max}$. 
Wo ist das Minimum der Durchschnittskosten (Betriebsoptimum) $x_{BO}$?

a) $p=5; K(x)=x^2-5x+9$

b) $p=24; K(x)= 0{,}5x^2+19x+8$

c) $p=16; K(x)= 2x^2+6x+8$

d) $p=12; K(x) = x^2+7x+4$

e) $p=10; K(x) = 0{,}25x^2+7{,}5x+4$

f) $p=4; K(x) = x^2-22x+144$

g) $p=20; K(x) = x^2-6x+144$

h) $p=60; K(x) = 2x^2+2x+200$

::: {.notes}

:::

### Multivariate Funktionen

Unter einer reellwertigen, **multivariaten Funktion**, wollen wir eine Funktion

$$\begin{aligned}
f\,:\, & D \phantom{(x, \dotsc, x)}\to Z \\
       & (x_1, \dotsc, x_n) \mapsto\, y = f(x_1, \dotsc, x_n)
\end{aligned}$$

mit $D \subseteq \mathbf{R}^n$ und $Z\subseteq \mathbf{R}$ verstehen.

$f$ bildet $x=(x_1,...,x_n)$ auf reelle Zahlen $y$ ab und mensch bezeichnet sie 
daher auch als **skalare Funktion**. 

Ihr Graph lässt sich als die Punktmenge
$$\operatorname{Graph}(f) = \left\{\left.(x_1,...,x_n, y) \in \mathbf{R}^{n+1} \right| f(x_1,...,x_n)=y\right\}$$
auffassen.
<!-- Beispiele von Ross/Christians -->

**Beispiele:** 

::: {.small}
:::::: {.columns}
::::::::: {.column width="33%"}

a) $\displaystyle f(x,y) = x^2+ y^3$

:::::::::
::::::::: {.column width="33%"}

b) $\displaystyle f(x_1, x_2) = x_1^2x_2^3$

:::::::::
::::::::: {.column width="33%"}

c) $\displaystyle f(x, y) = \frac{x}{y}+xy$

:::::::::
::::::
:::


### Partielle Ableitung

Werden für eine multivariate, reellwertige Funktion

$$\begin{aligned}
f\,:\, & D \phantom{(x, \dotsc, x)}\to Z \\
       & (x_1, \dotsc, x_n) \mapsto\, y = f(x_1, \dotsc, x_n)
\end{aligned}$$

Alle Variablen $x_j$ bis auf die $i$-te als Konstanten betrachtet 
(c.p. = ceteris paribus), dann heißt die Ableitung von $f$ nach $x_i$ die 
**partielle Ableitung von $f$ nach $x_i$**:

$$\frac{\partial f(x_1,\dotsc,x_n)}{\partial x_1} = f_{x_i}(x_1,\dotsc,x_n)$$

**Beispiele:**

<!-- Beispiel von Ross/Christians -->

a) $\displaystyle f(x,y) = x^2+ y^3$, $\displaystyle f_x(x,y) = 2x$, $\quad\displaystyle f_y(x,y)= 3y^2$

b) $\displaystyle f(x_1, x_2) = x_1^2 x_2^3$, $\displaystyle f_{x_1}(x_1, x_2) =2 x_1 x_2^3$, $\displaystyle\quad f_{x_2}(x_1, x_2) =3x_1^2 x_2^2$

c) $\displaystyle f(x, y) = \frac{x}{y}+xy$, $\displaystyle f_x(x,y) = \frac{1}{y} + y$, $\quad\displaystyle f_y(x,y) = -\frac{x}{y^2}+x$


### Übung `r nextExercise()`: {.exercise} 

<!-- Übung von Ross/Christians -->

Bestimmen Sie die partiellen Ableitungen der angegebenen Funktionen
nach $x$ und $y$:

a) $\displaystyle 4x^3+2y^4$

b) $\displaystyle 2x^2+6y$

c) $\displaystyle 3x^{-1}y^2$

d) $\displaystyle e^{x^2y}$

e) $\displaystyle e^{0{,}5x^2+0{,}5y^{-2}}$

f) $\displaystyle e^{\ln(x)}e^{\ln(y)}$

g) $\displaystyle x^y$

::: {.notes}

a) $f_x(x,y) =12x^2$ $\;$ $f_y(x,y)=8y^3$ 

b) $f_x(x,y) =4x$ $\;$ $f_y(x,y)=6$ 

c) $f_x(x,y) = - \frac{3y^2}{x}$ $\;$ $f_y(x,y)=\frac{6y}{x}$ 

d) $f_x(x,y) =2xye^{x^2y}$ $\;$ $f_y(x,y)=x^2e^{x^2y}$ 

e) $f_x(x,y) =xe^{0{,}5x^2+0{,}5/y^2}$ $\;$ $f_y(x,y)=-\frac{e^{0{,}5x^2+0{,}5/y^2}}{y^3}$ 

f) $f_x(x,y) =y$ $\;$ $f_y(x,y)=x$ 

g) $f_x(x,y) = yx^{y-1}$ $\;$ $f_y(x,y)=x^y \cdot \log(x)$ 

:::


### Gradient

Unter dem *Gradienten* einer multivariaten, reellwertigen Funktion 
$$\begin{aligned}
f\,:\, & D \phantom{(x, \dotsc, x)}\to Z \\
       & (x_1, \dotsc, x_n) \mapsto\, y = f(x_1, \dotsc, x_n)
\end{aligned}$$

mit $D \subseteq \mathbf{R}^n$ und $Z \subseteq \mathbf{R}$ verstehen wir 
den Ausdruck

$$\nabla f = \operatorname{grad}(f) =  \begin{pmatrix}\frac{\partial f}{\partial x_{1}}\\ \vdots\\ \frac{\partial f}{\partial x_{n}} \end{pmatrix},$$

dem Vektor der partiellen Ableitung in die Richtungen $x_1, \dotsc, x_n$.


Der Gradient zeigt in die Richtung der größten Änderung.

Der Betrag des Gradienten gibt den Wert der größten Änderungsrate an
diesem Punkt an.


### Beispiel Gradient

Gegeben sei ein Funktion $f: \mathbf{R}^2 \to \mathbf{R}$ mittels
$f(x,y)=2x^2-y^2.$ 
Die partiellen Ableitungen sind somit $\frac{{\partial f}}{{\partial x}} = 4x$
und $\frac{{\partial f}}{{\partial y}} = -2y$.

Damit ist 
$\operatorname{grad}(f) = \nabla f = \begin{pmatrix}4x\\-2y\end{pmatrix}.$

Für den Punkt $P(-2; -1)$ lautet der Gradientvektor 
$\displaystyle \begin{pmatrix}-8\\2\end{pmatrix}$.

Der Betrag ist 
$\displaystyle \left|\begin{pmatrix}-8\\2\\\end{pmatrix}\right| = \sqrt{(-8)^2 + 2^2} \approx 8{,}25$.


### 3D-Plot von $f(x,y)=2x^2-y^2$ 

```{r echo=FALSE, fig.align="center", out.width="75%"}
# f<- 0.75
fkt <- function(x,y) {
  return(2*x^2 - y^2)
}

x <- seq(-5, 5, 0.1)
y <- seq(-5, 5, 0.1)
z <- array(0:0, c(length(x),length(y)))

xi <- 0
yi <- 0

for (xx in x) {
  xi <- xi + 1
  yi <- 0
  for (yy in y) {
    yi <- yi + 1
    z[xi,yi] <- fkt(xx, yy)
  }
}


```

```{r echo=FALSE,fig.align="center", out.width="75%"}
#library("plot3D")

t <- seq(-5, 5, 0.1)
m <- mesh(t, t)
x <- m$x
y <- m$y
z <- fkt(x,y)

persp3D(x, y, z, 
        box = TRUE, 
        phi = 30, 
        theta = 35,
        nticks = 5,
        axes = TRUE,
        scale = 1.5,
        ticktype = "detailed",
        colkey = list(
          length = 0.5, 
          width = 0.5, 
          shift = 0.15,
        cex.axis = 0.8, cex.clab = 0.85),
        boder = TRUE,
        clab = c("z = f(x,y)"),
        plot = TRUE,
        colvar = z)
```




## Extremstellen multivariaten Funktionen



### Notwendige Bedingung / stationäre Punkte

Damit ein Punkt $x=(x_1, \dotsc, x_n) \in D \subseteq \mathbf{R}^n$ eine 
Extremstelle der Funktion $f:D \to Z \subseteq \mathbf{R}$ seien
kann, muss für den Gradient gelten:

$$\nabla f(x) = 0^n = \begin{pmatrix}0\\ \vdots \\0\end{pmatrix} \in \mathbf{R}^n$$

Punkte welche diese Bedingung erfüllen, nennen wir **stationäre Punkte**.

Mathematisch heißt das:

$$x \text{ ist eine Extremstelle von } f \Longrightarrow \nabla f(x) = 0^n$$


### Beispiel

Aus dem Beispiel $f(x,y)=2x^2-y^2$ mit dem Gradienten 
$\displaystyle \nabla f(x,y) = \begin{pmatrix}4x\\-2y\end{pmatrix}$ wissen wir, dass
der Punkt $(0; 0)$ ein *stationärer Punkt* ist, weil 
$$\nabla f(0,0) = \begin{pmatrix}\phantom{-}4\cdot 0\\-2 \cdot 0\end{pmatrix}= \begin{pmatrix}0\\0\end{pmatrix}$$
gilt.
Aber aus dem 3D Plot wissen wir, dass $(0; 0)$ keine Extremstelle ist!


### Hesse-Matrix

Für eine hinreichend oft differenzierbare Funktion $f: D \to Z$, mit 
$D \subseteq \mathbf{R}^n$ und $Z \subseteq \mathbf{R}$ ist für ein 
$x \in D$ die **Hesse-Matrix** wie folgt gegeben:

$$\operatorname{Hess}\left(f(x)\right) =
\begin{pmatrix}
 f_{x_1x_1}(x) & f_{x_1x_2}(x) & \cdots & f_{x_1x_n}(x) \\
 f_{x_2x_1}(x) & f_{x_2x_2}(x) & \cdots & f_{x_2x_n}(x) \\
 \vdots        & \vdots        & \ddots & \vdots \\
 f_{x_nx_1}(x) & f_{x_nx_2}(x) & \cdots & f_{x_nx_n}(x)
\end{pmatrix}$$


### Klassifikation stationärer Punkte

Sei $f: D \to Z$ eine hinreichend differenzierbare Funktion und 
$D \subseteq \mathbf{R}^n$ und $Z \subseteq \mathbf{R}$.und $x_0$ ein
stationärer Punkt ($\nabla f(x_0) = 0^n$).

a) **Notwendige Bedingung:**
   Ist $x_0$ ein lokales Extremum von $f(x)$, so gilt:
   
   - $x_0$ ist lokales Minimum $\Longrightarrow$ 
     $\operatorname{Hess}\left(f(x_0)\right)$ ist positiv semidefinit 
    
   - $x_0$ ist lokales Maximum $\Longrightarrow$ 
     $\operatorname{Hess}\left(f(x_0)\right)$ ist negativ semidefinit 

b) **Hinreichende Bedingung:**
   
   - Ist $\displaystyle \operatorname{Hess}\left(f(x_0)\right)$ positiv definit 
     (bzw. negativ definit), so ist $x_0$ ein strenges lokales Minimum 
     (bzw. Maximum) von $f(x)$.
     
   - Ist $\displaystyle \operatorname{Hess}\left(f(x_0)\right)$ indefinit, so ist
     $x_0$ ein Sattelpunkt.


<!-- -->


### Beispiel $f(x,y) = 4x^2+xy+7x+3y^2-5y$

Für $f(x,y) = 4x^2+xy+7x+3y^2-5y$ lautet der Gradient

$$\nabla f = \begin{pmatrix}8x+y+7\\x+6y-5\end{pmatrix}$$
und hat den stationären Punkt $(-1; 1)$. (TR!)

Die Hesse-Matrix für den Punkt $(-1; 1)$ lautet:
$$\operatorname{Hess}\left(f(1,1)\right) = \begin{pmatrix}
 8 & 1  \\
 1 & 6
\end{pmatrix}$$

Das charakteristische Polynom $\chi(\lambda) = (8-\lambda)(6-\lambda)-1=x^2-14x+49 = (x-7)^2$
liefert die Eigenwerte $\lambda_1=7$ und $\lambda_2=7$.

Da beide Eigenwerte positiv sind ist die Hesse-Matrix positiv definit und wir
haben an der Stelle $(-1; 1)$ ein strenges lokales Minimum.


### Beispiel $f(x,y) = -3x^2+xy+5x-4y^2+7y$

Für $f(x,y) = -3x^2+xy+5x-4y^2+7y$ lautet der Gradient

$$\nabla f = \begin{pmatrix}-6x+\phantom{8}y+5\\\phantom{-6}x-8y+7\end{pmatrix}$$
und hat den stationären Punkt $(1; 1)$. (TR!)

Die Hesse-Matrix für den Punkt $(-1; 1)$ lautet:

$$\operatorname{Hess}\left(f(1,1)\right) = \begin{pmatrix}
 -6 & 1  \\
 1 & -8
\end{pmatrix}$$

Das charakteristische Polynom $\displaystyle \chi(\lambda) = (-6-\lambda)(-8-\lambda)-1=x^2+14x+49 = (x+7)^2$
liefert die Eigenwerte $\lambda_1=-7$ und $\lambda_2=-7$.

Da beide Eigenwerte negativ sind ist die Hesse-Matrix negativ definit und wir
haben an der Stelle $(1; 1)$ ein strenges lokales Maximum.


### Beispiel $f(x,y)=2x^2-y^2$

Für $f(x,y)=2x^2-y^2$ lautet der Gradient 

$$\nabla f= \begin{pmatrix}4x\\-2y\end{pmatrix}$$

Es gibt einen stationären Punkt $(0; 0)$ und die Hesse-Matrix lautet:

$$\operatorname{Hess}\left(f(x,y)\right) = \begin{pmatrix}
 4 & 0  \\
 0 & -2
\end{pmatrix}$$

Da die Hesse-Matrix in diagonalgestalt ist, können wir die Eigenwerte ablesen:
$\lambda_1 = 4$, $\lambda_2 = -2$.

Da die beiden Eigenwerte unterschiedliche Vorzeichen haben, ist die 
Hesse-Matrix indefinit. 

Der Punkt $(0; 0)$ liefert somit einen Sattelpunkt.


### Übung `r nextExercise()`: {.exercise} 
<!-- Aufgabe von Ross/Christians -->

Bestimmen Sie für die folgenden Funktionen den stationären Punkt $(x_0; y_0)$
und geben Sie an, ob es sich um eine Maximum, Minimum oder einen Sattelpunkt 
handelt:

a) $\displaystyle f(x,y) = -x^2+24x-2y^2+40y-2xy-3$

b) $\displaystyle f(x,y) = 2x^2-24x+2y^2-18y+2xy+3$

c) $\displaystyle f(x,y) = 2x^2-10x-2y^2+2xy-2$

d) $\displaystyle f(x,y) = x^2+24x+2y^2+40y-3xy$

e) $\displaystyle f(x,y) = 2x^2-30x+3y^2-10y-2xy$

f) $\displaystyle f(x,y) = -2x^2+24x-5y^2+5xy-1$

g) $\displaystyle f(x,y) = x^2+4x-5y^2+10y-4xy$

h) $\displaystyle f(x,y) = -x^2+120x+2y^2+120y-4xy$

::: {.notes}

a) Maximum bei $(4, 8)$ mit $f(4,8)=205$

b) Minimum bei $(5,2)$ mit $f(5,2) = -75$

c) Sattelpunkt bei $(2,1)$ mit $f(0,0)= -12$

d) Sattelpunkt bei $\left(\frac{44}{3},\frac{160}{9}\right)$ mit $f\left(\frac{44}{3},\frac{160}{9}\right)= \frac{91\,376}{81}$

e) Minimum bei $(10, 5)$ mit $f(10, 5)= -175$

f) Maximum bei $(16, 8)$ mit $f(16, 8)= 191$

g) Sattelpunkt bei $(0,1)$ mit $f(0,1) = 5$

h) Sattelpunkt bei $(40, 10)$ mit $f(40,10)= 3000$

:::

### Übung `r nextExercise()`: {.exercise} 

Die Funktion $f(x,y) = y^2(x-1) + x^2(x+1)$ besitzt **zwei** stationäre Punkte.

a) Bestimmen Sie die beiden stationären Punkt $(x_0; y_0)$ und $(x_1; y_1)$.

b) Berechnen Sie die Hesse-Matrizen und entscheiden Sie, ob die Punkte lokale 
   Extremstellen sind (und welcher Typ) oder Sattelpunkte.

::: {.notes}

a) $f_x(x,y)= 3x^2 + 2x +y^2$, $f_y(x,y)=2xy-2y$, 
    Für $y=0$ folgt $f_x(x,0) = 3x^2+2x = (3x+2)x$ und damit $x=0$ oder $x=\frac{-2}{3}$.
    Für $y\neq 0$ folgt aus $2xy-2y=0 \Leftrightarrow x=1$ und
    $f_x(1,y)= 3+2+y^2 \neq 0$ für alle $y \in \mathbf{R}$.
    Daher gibt es die zwei stationären Punkte: $(0,0)$ und $\left(-\frac23, 0\right)$

b) $\operatorname{Hess}\left(f(x,y)\right) = \begin{pmatrix}6x+2  & 2y \\ 2y & 2x-2\end{pmatrix}$
    Für $(0,0)$ ergibt sich $\operatorname{Hess}\left(f(0,0)\right) =\begin{pmatrix}2  & 0 \\ 0 & -2\end{pmatrix}$. Die Eigenwerte sind somit $2$ und $-2$, damit ist die Matrix indefinit und somit liegt hier ein Sattelpunkt vor.
    Für $\left(-\frac23, 0\right)$ ist $\operatorname{Hess}\left(\left(-\frac23, 0\right)\right) = \begin{pmatrix}-2  & 0 \\ 0 & -\frac{10}{3}\end{pmatrix}$.
    Die Eigenwerte sind $-2$ und $-\frac{10}{3}$, damit ist die Matrix negativ definit. 
    Es liegt also ein lokales Maximum vor, $f\left(-\frac23, 0\right) = \frac{4}{27}$.

:::


### Minimierungsproblem {include-only=LangeFassung}
...

<!-- -->


### Maximierungsproblem {include-only=LangeFassung}
...

<!-- -->


### Ausblick: Gradientenverfahren {include-only=LangeFassung}
...

<!-- -->


### Totales Differential

Die Summe aller partiellen Ableitungen einer Funktion nennt man das **totale Differential** und schreibt dafür $d f$.


**Beispiel:**

Sei $f(x,y)$ eine bivariate reellwertige Funktion, so ist:

$$d f(x,y) = f_x(x,y) \cdot dx + f_y(x,y) \cdot dy$$

**Interpretation:**

Die totale Änderung einer Funktion setzt sich zusammen aus den Änderungen, 
die sich in jeder Koordinatenrichtung ergeben.




## Extrema unter Nebenbedingungen 

### Das allgemeine Problem

Gegeben ist eine (Ziel-)Funktion $f: D \to Z$ mit $D \subseteq\mathbf{R}^n$ und
$Z \subseteq \mathbf{R}$. Weiterhin seien $m$ verschiedene Nebenbedingungen in 
der Form $g_i: D \to Z$ ($i=1,...,m)$ mit $g_i(x) = 0$.

Wir suchen nun das $x$ aus der Menge der aller $x$, welche die Nebenbedingungen 
$g_i$ erfüllen, bei dem $f(x)$ den größten bzw. kleinsten Wert annimmt.



### Beispiel: Nutzen aus dem Konsum zweier Güter


Betrachtet werden zwei Güter, deren Konsummengen $x_1$ und $x_2$ dem Verbraucher 
einen Nutzen stiften, der durch die Nutzenfunktion $U(x_1,x_2)=x_1 \cdot x_2$ 
beschrieben wird.

Weiterhin verfügt der Verbraucher über ein begrenztes Einkommen in Höhe von 
$Y = 300$, und die Preise der beiden Güter sind $p_1 = 3$ und $p_2 = 6$.

**Frage:** Welche Kombination aus den beiden Gütern maximiert den Nutzen unter Einhaltung des gegebenen Einkommens?

**Modellierung:**
Maximierte $U(x_1, x_2) = x_1 \cdot x_2 \to \max!$ unter der 
Nebenbedingen $300 = 3 \cdot x_1 + 6 \cdot x_2$.

**Lösungswege:**  

- Einsetzungsverfahren

- Lagrangemethode


### Einsetzungsverfahren (am Beispiel)

Forme $300 = 3 \cdot x_1 + 6 \cdot x_2$ so um, das wir eine Variable, z.B. $x_1$,
durch die andere ausdrücken können:

$x_1 = \frac{300 - 6x_2}{3} = 100 - 2 x_2$

Setze nun $100 - 2 x_2$ für $x_1$ in die Funktion $U(x_1, x_2)$ ein:

$U(x_2) = U(100 - 2 x_2, x_2) = (100 - 2 x_2)\cdot x_2 = 100 x_2 - 2 x_2^2$

Bestimme nun das Maximum von $U(x_2)$:

$U'(x_2) = 100 - 4 x_2 = 0 \Leftrightarrow x_2 = 25$, $U''(x_2) = -4$ (also Maximum an der Stelle $x_2 = 25$)

Und berechne nun $x_1 = 100 - 2 \cdot 25 = 50$. 

Wir haben damit bei $x_1=50$, $x_2 = 25$ einen maximalen Nutzen von $U(50,25)=1250$.


### Lagrangemethode

Wir formulieren zunächst eine *Lagrangefunktion* $L_f(x,\lambda)$ mit 
$x\in\mathbf{R}^n$ und $\lambda=\mathbf{R}^m$ mittels:

$$L_f(x_1,...x_n,\lambda_1,...\lambda_m) = f(x_1,...,x_n) + \sum_{i=1}^m \lambda_i \cdot g_i$$
Bestimmt man nun die Lösung von 

$$\nabla L_f(x,\lambda) = 0^{n+m}$$

So liefern die Werte $x_1,...,x_n$ die gesuchte(n) Werte für eine Extremstelle.


### Beispiel

Betrachtet werden zwei Güter, deren Konsummengen $x_1$ und $x_2$ dem Verbraucher 
einen Nutzen stiften, der durch die Nutzenfunktion $U(x_1,x_2)=x_1 \cdot x_2$ 
beschrieben wird. 

Weiterhin verfügt der Verbraucher über ein begrenztes Einkommen in Höhe von 
$Y = 300$, und die Preise der beiden Güter sind $p_1 = 3$ und $p_2 = 6$. 


*Wir erhalten:* Zielfunktion $f(x_1, x_2) = U(x_1, x_2) = x_1 \cdot x_2$ und 
Nebenbedingung $g(x_1, x_2) = 300 - (3 x_1 + 6 x_2)$

Die Lagrangefunktion lautet dann:
$$L(x_1, x_2, \lambda) = x_1 \cdot x_2 + \lambda (300 - 3 x_1 - 6 x_2)$$
Damit ist

$$\nabla L(x_1, x_2, \lambda) = \begin{pmatrix} x_2 - 3 \lambda\\ x_1 - 6 \lambda \\ 300 - 3 x_1 - 6 x_2\end{pmatrix}$$

Und wir erhalten als Lösung von $\nabla L(x_1, x_2, \lambda) = 0^3$:
$x_1=50$, $x_2=25$, $\lambda=25/3$


### Bedeutung des Lagrange-Multiplikators (am Beispiel)

Was hat es nun mit dem $\lambda = 25/3$ aufsich?

Unsere Nebenbedingung hat mit $Y=300$ eine Konstante. 
Ersetzen wir in der Nebenbedingung die 300 durch $Y$ und leiten dann formal 
$L(x_1, x_2, \lambda, Y)$ nach $Y$ ab, so erhalten wir:

$$\frac{\partial L}{\partial Y} = \lambda$$

Im Maximum gilt nur $L(x_1, x_2, \lambda) = U(x_1, x_2)$, 

Der *Lagrange-Multiplikator* ($\lambda$) gibt an, in wie sich das Optimum ändert, 
falls sich die Konstante $Y$ der Nebenbedingung verändert.

Würden wir also $Y=303$ statt $Y=300$ als Einkommen annehmen, so sollte sich 
das Nutzenmaximum von $1\,250$ um (ca.) $\frac{25}{3}\cdot 3 = 25$ auf 
(etwa) $1\,275$ steigern lassen.

Rechnen Sie es (als Hausaufgabe) nach!^[Lösung: $x_1=50{,}5\; x_2 = 25{,}25\$ 
Nutzenmaximum: $1275{,}125$]


### Übung `r nextExercise()`: {.exercise} 

<!-- Übungen von Ross/Christians -->

Gegeben sei die eine Nutzenfunktion $U(x_1,x_2)$, das Haushaltseinkommen $Y$ und
die Preise zweier Konsumgüter $p_1$ und $p_2$. 
Berechnen Sie das nutzenmaximale Güterbündel!

a) $\displaystyle U(x_1,x_2)=2x_1+6x_2+2x_1x_2+3$; $Y=70$; $p_1=2$; $p_2=4$

b) $\displaystyle U(x_1,x_2)=2x_1+2x_2+x_1x_2+4$; $Y=76$; $p_1=2$; $p_2=4$

c) $\displaystyle U(x_1,x_2)=3x_1+2x_2+x_1x_2$; $Y=501$; $p_1=3$; $p_2=1$

d) $\displaystyle U(x_1,x_2)=4x_1+4x_2+2x_1x_2+4$; $Y=22$; $p_1=4$; $p_2=1$

e) $\displaystyle U(x_1,x_2)=4x_1+2x_2+x_1x_2+6$; $Y=24$; $p_1=3$; $p_2=2$

f) $\displaystyle U(x_1,x_2)=-30x_1-3x_2+3x_1x_2+10$; $Y=48$; $p_1=4$; $p_2=2$

g) $\displaystyle U(x_1,x_2)=-3x_1-2x_2+x_1x_2+6$; $Y=64$; $p_1=4$; $p_2=8$

h) $\displaystyle U(x_1,x_2)=-x_1+3x_2+x_1x_2-3$; $Y=86$; $p_1=6$; $p_2=8$



```{r finish-Differenzialrechnung, include=FALSE}
finalizePart(partname)
```