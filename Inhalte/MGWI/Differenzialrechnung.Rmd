```{r setup-MGDWI-Differenzialrechnung, include=FALSE}
# ---------------------------------------------------------------------------
#% maintainer:
#%   - Norman Markgraf
#%
# ---------------------------------------------------------------------------
source("../../prelude.R")
initPart(
    "Differenzialrechnung",  # Dateiname ohne Suffix
    "Differenzialrechnung"   # Verzeichnisname im Bilderverzeichnis 
    )
pathToImages = getPathToImages()
# ---------------------------------------------------------------------------

```

# Differenzialrechnung 

## Elementare Funktionen 

### Univariate Funktion

Unter einer **univariaten** Funktionen, also Funktionen in einer Variabeln, 
verstehen wir:

$$\begin{aligned}
f\,:\, & D \to Z \\
       & x \,\mapsto\, y = f(x)
\end{aligned}$$

Dabei bezeichnet $f$ eine **Funktion**, welche jedem Element $x$ aus der 
**Definitionsmenge** $D$ mit Hilfe der 
**Zuordnungsvorschrift** $f(x)$ genau ein Element $y$ aus der 
**Zielmenge** $Z$ gemäß der **Funktionsgleichung** $y=f(x)$ 
zuordnet.

Ist $Z \subseteq \mathbf{R}$, so nennen wir die Funktion **reellwertig**.

Zunächst soll dabei $D\subseteq \mathbf{R}$ gelten.

Die Menge $G_f = \left\{(x,y) \in D \times Z \,|\, y = f(x)\right\}$ wollen wir 
den *Graph der Funktion $f$* nennen.

Fasst man den Graphen von $f$ als Relation ($x \sim_f y :\Leftrightarrow y=f(x))$ 
auf, so ist $\sim_f$ *linkstotal* und *rechtseindeutig* (also *funktional*).


### Beispiele für Funktionen der Wirtschaftswissenschaften

- **Kostenfunktion $K(x) = K_{var}(x) + K_{fix}$:** 
  Zusammenhang zwischen Produktionsmenge und Gesamtkosten, setzt sich zusammen 
  aus *variablen Kosten* $K_{var}(x)$ (abhängig von der Menge $x$) sowie den 
  *Fixkosten* $K_{fix}$. 

- **Durchschnittskostenfunktion $DK(x)=K(x)/x$:**
  Auch **Stückkostenfunktion** gennannt, liefert den Kostenanteil einer 
  produzierten Einheit.

- **Preis-Absatz-Funktion $P(x)$:**
  Zusammenhang zwischen Stückpreis $P$ und der Absatzmenge $x$ 
  (Nachfragefunktion).

- **Umsatz- oder Erlösfunktion $E(x)$:**
  Zusammenhang zwischen Preis $P(x)$, Absatz(menge) $x$ und 
  Erlös $E(x) = P(x)\cdot x$.

- **Gewinnfunktion $G(x)$:** 
  Zusammenhang zwischen Produktions- bzw. Absatzmenge und dem Gewinn 
  $G(x) = E(x) - K(x)$. 


### Bild und Urbild {include-only=LangeFassung}

...

<!-- -->

### Transformation von Funktionen

Eine Funktion 

$$\begin{aligned}
f\,:\, & D \to Z \\
       & x \,\mapsto\, y = f(x) \phantom{\left(\frac{1}{1} ()\right)}
\end{aligned}
 \text{ geht über in } \quad
\begin{aligned}
g\,:\, & D \to Z \\
       & x \,\mapsto\, y = a \cdot f\left(\frac{1}{b} \cdot (x-c)\right)+ d
\end{aligned}$$


durch eine 

- **Streckung** um $a$ in $y$-Richtung
- **Streckung** um $b$ in $x$-Richtung
- **Verschiebung** um $c$ in $x$-Richtung
- **Verschiebung** um $d$ in $y$-Richtung

Insbesondere ist

- $a=-1$ eine **Spiegelung** an der $x$-Achse
- $b=-1$ eine **Spiegelung** an der $y$-Achse


### Konstante Funktionen

Eine *konstante Funktion* ist eine Funktion $f$, die für alle Argumente 
denselben Wert $c \in Z$ annimmt.

$$\begin{aligned}
f\,:\, & D \to Z \\
       & x \,\mapsto\, y = c
\end{aligned}$$


Der Graph einer *konstante reelwertige Funktion*, 
ist eine parallele zur X-Achse:
$$G_f = \left\{(x, c) \,|\, c \in Z \wedge \forall x \in D \right\}$$

### Beispiele

a) Im Allgemeinen muss $f$ nicht immer eine reellwertige Funktion sein. 
   Betrachten wir als Beispiel einmal die folgende Funktion auf dem 
   Restklassenring modolo 2:
$$\begin{aligned}
f\,:\, & \mathbf{Z}/2 \mathbf{Z} \to \mathbf{Z}/2 \mathbf{Z} \\
       & x \,\mapsto\, y = x^2-x
\end{aligned}$$
   Wegen $0^2 - 0 = 0$ und $1^2 - 1 = 0$ ist diese Funktion eine konstante Funktion!

b) Ist der Wert der konstanten Funktion immer Null, so nennt man die Funktion
   auch *Nullfunktion*. Ist also $0 \in Z$, so ist 
$$\begin{aligned}
f\,:\, & D\to Z \\
       & x \,\mapsto\, y = 0
\end{aligned}$$
   eine Nullfunktion.


### Lineare Funktionen / Geraden

Unter einer *(affin-)linearen Funktion* $f$ wollen wir die *Geraden* verstehen, 
welche keine konstante Funktion ist.

Sie lässt sich durch die folgenden *Zuordnungsvorschriften* beschreiben:

:::::: {.columns}
::: {.column width="49%"}

**Steigungsform:**
$$y = f(x) = m \cdot x + b$$
Mit der *Steigung* $m$ und dem Y-Achsenabschnitt $b$. 
Die Nullstelle $a$ von $f$ lautet: $a=-\frac{b}{m}$

:::
::: {.column width="49%"}

**Normalenform:**
$$\frac{1}{a} \cdot x + \frac{1}{b} \cdot y = 1$$
Mit dem Y-Achsenabschnitt $b \neq 0$ und der Nullstelle $a \neq 0$. 
Die Steigung $m$ lautet dann: $m=-\frac{b}{a}$. 
::: 
::::::



:::::: {.columns}
::: {.column width="49%"}

**Punkt-Steigungsform:**
$$y = f(x) = m \cdot (x-x_0) + b$$
Mit der *Steigung* $m$ und dem Y-Achsenabschnitt $b$. 
Die Nullstelle $a$ von $f$ lautet: $a=-\frac{b}{m}$

:::
::: {.column width="49%"}

**Linear Faktorform:**
$$y = m \cdot (x-x_0)$$
Mit dem Y-Achsenabschnitt $b \neq 0$ und der Nullstelle $a \neq 0$. 
Die Steigung $m$ lautet dann: $m=-\frac{b}{a}$. 
::: 
::::::


Ist $b=0$, also $f(x) = m\cdot x$, so sprechen wir auch von einer 
*homogen linearen Funktion* oder *Proportionalität*.


### Übung

Eine lineare Funktion lässt sich immer durch die Angabe
- von zwei (nicht identischen) Punkten ($P$ und $Q$) oder
- eines Punktes $P$ und der Steigung $m$
bestimmen.

Geben Sie für folgenden zwei Punkte ($P$ und $Q$) bzw. für den Punkt $P$ und 
die Steigung $m$ jeweils die lineare Funktion in der Steigungsform und 
der Normalenform an:

a) $P=(1; 2)$, $Q=(2; 4)$

b) $P=(100; 50)$, $Q=(-5; 75)$

c) $P=(5; 5)$, $m=-2$

d) $P=(2; 4)$, $m=4$

e) $P=(1; 7)$, $m=7$

**Zusatzfrage:** Ist eine der obigen Funktionen *homogen lineare*? -- 
Falls ja, welche und wieso?


### Übung

Betrachten Sie den Markt für ein Produkt ($P$=Preis, $x$=(Absatz-)Menge), 
für das aufgrund von Erfahrungen die beiden Preis-Verkaufsmengenkombinationen 
$(P_1, x_1) = (30, 100)$ und  $(P_2, x_2) = (25, 150)$ vorliegen.

a) Wie lautet die Nachfragefunktion, wenn eine lineare Beziehung unterstellt 
   wird?
   
b) Wie viel kann dann voraussichtlich verkauft werden, wenn der Preis auf $20$ 
   gesenkt wird? 


### Übung (nach Steward, Calculus, 7th ed.)

Der Manager einer Möbelﬁrma ﬁndet heraus, dass die Herstellung von 100 Stühlen 
am Tag $2\,200$ US-\$, während die Herstellung von 300 Stühlen am Tag 
$4\,800$ US-\$ kostet.

- Stellen Sie die Kosten als eine Funktion der Anzahl hergestellter Stühle dar.

- Was bedeuten in diesem Zusammenhang Achsenabschnitt und Steigung?


### Polynome

Der formale Ausdruck

$$a_n x^n + a_{n-1} x^{n-1} + \dotsb + a_2 x^2 + a_1 x + a_0 = \sum_{k=0}^n a_k x^k$$

mit den $n \in \mathbf{N}$ **Koeffizienten** 
$a_0, ..., a_{n-1}$ und $a_n\neq 0$ aus einer Menge $R$ 
bezeichnet man als **Polynom vom Grad $n$ über $R$** . 

Die Menge aller Polynome über $R$ bezeichnet mensch mit $R[x]$. 


### Die Gradfunktion für Polynome

Die **Gradfunktion** $\deg$ ist definiert durch:

$$\begin{array}{rccl}
\deg\colon & R[x] & \to & \quad \mathbf{N}_0 \cup \{-\infty\} \\
  & f & \mapsto & \begin{cases}
  \max\left\{k\in\mathbf{N}_0\mid a_k\ne 0\right\}, & \text{falls } f \neq 0\\
  -\infty, & \text{falls } f = 0
\end{cases}
\end{array}$$ 

Sie liefert für jedes Polynom den dazugehörigen Grad.

Für zwei Polynome $p$ und $q$ gilt dann:

- $\deg(p \cdot q) \leq \deg(p) \cdot \deg(q)$
- $\deg(p + q) \leq \max\left(\deg(p), \deg(q)\right)$


### Ganzrationale Funktionen

Eine Funktion $f$, die sich mit Hilfe eines Polynoms aus $\mathbf{R}[x]$ 
darstellen lässt bezeichnen wir als *ganzrationale Funktion*:


:::::: {.columns}
:::{.column width="39%"}

$$\begin{aligned}
f\,:\, & D\to Z \\
       & x \,\mapsto\, y = \sum_{k=0}^n a_k x^k
\end{aligned}$$
:::
::: {.column width="59%"}

+--------------+--------------------------------------------+
| $\deg(f)$    | Bezeichnung                                |
+:=============+:===========================================+
| $-\infty$    | Nullfunktion                               |
+--------------+--------------------------------------------+
| $0$          | Konstante Funktion                         |
+--------------+--------------------------------------------+
| $1$          | Lineare Funktion                           |
+--------------+--------------------------------------------+
| $2$          | Quadratische Funktion                      |
+--------------+--------------------------------------------+
| $3$          | Kubische Funktion                          |
+--------------+--------------------------------------------+
| $4$          | Quartische Funktion                        |
+--------------+--------------------------------------------+

:::
::::::

### Übung


a) Seien $p=1+2x$ und $q=1+3x$ zwei Polynome über $\mathbf{Z}$ vom Grad 1.
   - Berechnen Sie $p \cdot q$ und bestimmen sie den Grad dieses Polynoms!
   - Berechnen Sie $p + q$ und bestimmen sie den Grad dieses Polynoms!


b) Seien $p=1+2x$ und $q=1+3x$ zwei Polynome über dem Restklassenring 
   $\mathbf{Z}/6\mathbf{Z}$ vom Grad 1.
   - Berechnen Sie $p \cdot q$ und bestimmen sie den Grad dieses Polynoms!
   - Berechnen Sie $p + q$ und bestimmen sie den Grad dieses Polynoms!


### Linearfaktoren und Linearfaktorzerlegung

Ist der Funktionsterm einer ganzrationalen Funktion als Produkt von 
linearen Faktoren (von denen manche auch mehrfach auftreten können) und evtl. 
einer ganzrationalen Funktion $g$ ohne Nullstellen gegeben, also

$$f(x) = (x - x_1)^{k_1} \cdot (x - x_2)^{k_2} \dotsm (x - x_m)^{k_m} \cdot g(x),$$

so sind $x_1, x_2, \dotsc, x_m$ die *Nullstellen*. 
Die natürlichen Zahlen $k_1, k_2, \dotsc, k_m$ heißen die **Vielfachheiten der Nullstellen**.

**Beispiel:** Die Funktion
$$f\colon x \mapsto -0{,}01 \cdot x^3 \cdot (x - 2) \cdot (x + 3)^2 \cdot (x^2 + 1)$$
hat die dreifache Nullstelle $x_1 = 0$, die einfache Nullstelle $x_2 = 2$ 
und die doppelte/zweifache Nullstelle $x_3 = -3$; 
die Faktoren $-0{,}01$ und $x^2+1$ können dagegen für kein $x$ zu null werden,
liefern also keine weiteren Nullstellen. 

Somit ist dann mit $g(x)= -0{,}01(x^2+1)$:

$$f(x)= x^3 \cdot (x - 2) \cdot (x + 3)^2 \cdot g(x)$$



### Übung 
...

<!-- -->

### Quadratische Funktionen 

Eine nicht konstante und nicht lineare Funktion, die man mit Hilfe eines
*Polynom zweiten Gerades* darstellen kann wollen wir **quadratische Funktion** 
nennen:

:::::: {.columns}
::: {.column width="49%"}

$$\begin{aligned}
f\,:\, & D\to Z \\
       & x \,\mapsto\, y = a \cdot x^2 + b \cdot x + c
\end{aligned}$$

Dabei sind $a \neq 0$, $b$, $c$ die *Koeffizienten* der Funktion.
:::
::: {.column width="49%"}
**Nullstellen:**
Falls vorhanden sind die Nullstellen $x_1$, $x_2$ gegeben durch:

$$x_{1,2} =  \frac{-b\pm\sqrt{b^2-4ac}}{2a}$$


**Scheitelpunktsform**:
Die Funktion $f$ kann auch durch
$$f(x) = a \cdot \left(x - x_s\right)^2 + y_s$$
mit $x_s = \frac{x_1 + x_2}{2}$, 
$y_s = f(x_s) = -\frac{a}{4}\cdot\left(x_2-x_1\right)^2$ dargestellt werden.

:::
::::::

Den Graph einer *quadratischen Funktion* nennt man **Parabel**.


### Beispiele quadratischer Funktionen

:::::: {.columns}
::: {.column width="49%"}
```{r warning=FALSE, echo=FALSE, fig.align="center", out.width="95%"}
library(ggplot2)

myFun <- function(x, a, xs, ys) {
  res <- a*(x - xs)**2 + ys
  return(res)
}

my.df <- data.frame(x = c(-3.5,3.5))
ggplot(my.df, aes(x = x)) +
  geom_vline(aes(xintercept = 0)) +
  geom_hline(aes(yintercept = 0)) +
  stat_function(fun = myFun, n = 1000, 
                args = list(a =  2, xs =  0, ys =  0), 
                aes(colour = "2*x^2")) +
  stat_function(fun = myFun, n = 1000, 
                args = list(a =  2, xs = -2, ys = -2), 
                aes(colour = "2*(x-2)^2-2")) +
  stat_function(fun = myFun, n = 1000, 
                args = list(a =  2, xs =  2, ys =  2), 
                aes(colour = "2*(x+2)^2+2")) +
  stat_function(fun = myFun, n = 1000, 
                args = list(a = -2, xs = -2, ys =  2), 
                aes(colour = "-2*(x-2)^2+2")) +
  stat_function(fun = myFun, n = 1000, 
                args = list(a = -2, xs =  2, ys = -2), 
                aes(colour = "-2*(x+2)^2-2")) +
  scale_colour_manual("Funktionen:", 
                      values = c("blue", "green", "orange", "yellow", "red")) +
  theme(legend.title = element_text(size = 22, face = "bold")) +
  theme(legend.text = element_text(size = 18)) +
  coord_cartesian(xlim =  c(-3, 3), ylim = c(-10, 10)) + 
  theme(legend.position = "bottom") +
  guides(colour = guide_legend(ncol = 3,nrow = 2,byrow = TRUE))


```

:::
::: {.column width="49%"}
:::: {.small}
Es gilt
$$a\cdot(x-x_s)^2+y_s = a\cdot x^2 + b\cdot x + c$$
mit $b = -2\cdot a \cdot x_s \cdot x$ und $c =  a \cdot x_s^2 + y_s$



**Zum Beispiel:**

- $-2(x-2)^2+2 = -2x^2 + 8x - 6$

- $-2(x+2)^2-2 = -2x^2 - 8x - 10$

- $\phantom{-}2(x-2)^2-2 = \phantom{-}2x^2 - 8x + 6$

- $\phantom{-}2(x+2)^2+2 = \phantom{-}2x^2 + 8x+ 10$

::::
:::
::::::

### Kubische Funktionen {include-only=LangeFassung}

Eine Funktion, die man mit Hilfe eines
*Polynom dritten Gerades* darstellen kann wollen wir **kubische Funktion** 
nennen:

$$\begin{aligned}
f\,:\, & D\to Z \\
       & x \,\mapsto\, y = a \cdot x^3 + b \cdot x^2 + c \cdot x + d
\end{aligned}$$

Dabei sind $a \neq 0$, $b$, $c$ und $d$ die *Koeffizienten* der Funktion.


<!-- -->


### Potenzfunktionen / Wurzelfunktionen

Als **Potenzfunktionen** bezeichnen wir eind Funktion der Form:

$$f : x \mapsto a x^r \qquad a, r \in \mathbf{R}.$$

Ist der **Exponent** $r$ darstellbar durch $r= \frac{1}{n}$ für ein 
$n \in \mathbf{N}$, so nennen wir die Funktion auch **Wurzelfunktion**.

<!-- -->


### Exponetialfunktionen

Die Exponentialfunktion zu der Basis $e$ kann auf den reellen Zahlen u.a. durch
$$\exp(x) = \lim_{n \to \infty} \left( 1 + \frac{x}{n} \right)^n$$
definiert werden. Es ist dann 
$$e=exp(1)\approx 2{,}71828 \, 18284 \, 59045 \, 23536 \, 02874 \, 71352 \, 66249 \, 77572 \, 47093 \, 69995 \, \dots$$ 
und umgekehrt $\exp(x) = e^x$.

Eine Exponentialfunktion zu einer beliebigen Basis $a$ ist dann:
$$a^x = exp(x \cdot \ln(a))$$
Wobei $\ln(x)$ die Umkehrfunktion von $\exp(x)$ ist und **natürlicher Logarithmus** genannt wird.

<!-- -->


### Logarithmenfunktionen

...

<!-- -->


### Sinus / Cosinus {include-only=LangeFassung}
...

<!-- -->


### Logistische Funktionen


<!-- -->


### Betragsfunktion


<!-- -->


## Stetigkeit

Eine Funktion ist **(folgen-)stetig**, wenn für alle $h>0$ gilt:

$$\lim_{h \to 0} f(x+h) = f(x) = \lim_{h \to 0} f(x-h)$$

Eine stetige Funktion hat keine **Sprungstellen** und "lässt ich ohne Absetzen durchzeichnen".


### Zwischenwertsatz

Eine *stetige Funktion* $f$, die zwischen zwei Stellen $x_0$ und $x_1$ das Vorzeichen wechselt, also
$f(x_0)\cdot f(x_1) < 0$, hat zwischen $x_0$ und $x_1$ mindestens eine Nullstelle.


## Steigungen von Funktionen

### Sekante

Sei $f:D \to Z$ eine Funktion mit $a<b$ und $a, b \in D$. 
Dann gibt es zu den Punkten $P(a; f(a))$ und $Q(b; f(b))$ immer eine Gerade 
$g_{PQ}$, welche die beiden Punkte $P$ und $Q$ miteinander verbindet.

Sollte für alle $c \in (a, b)$ die Punkte $S(c, f(c))$ nicht auf der Geraden
liegen, so nennen wir die Gerade $g_{PQ}$ eine **Sekante**.


### Sekantensteigung / Differenzenquotient

Für eine Funktion $f:D \to Z$ und zwei Werte $x_0 < x_1$ aus $D$ nennen wir 
die Steigung der Sekante $s$ zwischen den Punkten $P(x_0; f(x_0))$ und 
$Q(x_1; f(x_1))$

$$m_s = \frac{f(x_1)- f(x_0)}{x_1-x_0}$$

die **Sekantensteigung** oder auch **Durchschnittssteigung** bzw 
**Differenzenquotient** von $f$ im Intervall $[x_0, x_1]$.

Die Sekante wird dann durch den folgendenFunktionsterm beschieben:
$$m_s \cdot x + b_s$$
Dabei ist $b_s = f(x_0) - m_x \cdot x_0 = f(x_1) - m_x \cdot x_1$.


### Übung

Bestimmen Sie jeweils die Sekante und die Sekantensteigung für die 
angegebenen Funktionen $f$ an den Stellen $x_0$ und $x_1$.

a) $f(x) = x^2$, $x_0=0$, $x_1=4$

b) $f(x) = x^2$, $x_0=2$, $x_1=4$

c) $f(x) = x^3-3x+1$, $x_0=-1$, $x_1=1$

d) $f(x) = x^3-3x+1$, $x_0=0$, $x_1=2$

e) $f(x) = x^3-3x+1$, $x_0=1$, $x_1=2$


**Zusatzaufgabe:** Skizzieren Sie für jede Teilaufgabe die Funktion und Sekante 
in einem Diagramm. 

Alternativ schauen Sie sich jeweils die Graphen mit Hilfe eines "Plotprogramms" an.
Z.B.: https://www.mathe-fa.de/de 


### Die $\Delta$-Notation

Statt $x_1 - x_0$ wollen wir zur Abkürzeung $\Delta x_0$ schreiben, in dem wir festlegen:

$$x_1 = x_0 + \Delta x_0 \quad \Longleftrightarrow \Delta x_0 = x_1 - x_0$$

Analog wollen wir statt $f(x_1) - f(x_0)$ kurz $\Delta f(x_0)$ schreiben, in dem wir festlegen:

$$\Delta f(x_0) = f(x_0 + \Delta x_0)- f(x_0) = f(x_1) - f(x_0)$$

Damit lässt sich der Differenzenquotient wie folgt zusammenfassen:

$$m_s = \frac{f(x_1)- f(x_0)}{x_1-x_0} = \frac{\Delta f(x_0)}{\Delta x_0}$$


### Tangentensteigung / Differenzialquotient / Ableitung

Eine (reelle) Funktion $f : D \to Z$ heisst an der Stelle $x_0 \in D$  differenzierbar, falls
der Grenzwert 
$$\lim_{\Delta x_0 \to 0} \frac{\Delta f(x_0)}{\Delta x_0} = \lim_{h \to 0} \frac{f(x_0+h)- f(x_0)}{h}$$ 
existiert. 
Wir nennen der Grenzwert **erste Ableitung** oder **Differenzialquotient** von $f$ an der Stelle $x_0$ und bezeichnen diesen mit:
$$f'(x_0) = \frac{d f(x_0)}{d x_0}$$

Die erste Ableitung $f'(x_0)$ ist gleich der **Tangentensteigung** in dem Punkt $(x_0, f(x_0))$, 
also einer Geraden $t(x) = m_t \cdot x + b_t$, welche die Funktion $f$ im Punkt $(x_0, f(x_0))$ berührt und in diesem Punkt die selbe Steigung wie $f$ hat, also $m_t = f'(x_0)$ und $b_t = f(x_0) - m_t \cdot x_0$. 


### Näherungseigenschaften der Tangente

Durch eine leichte Umformung erhalten wir aus der Tangenten
$$t(x) = m_t \cdot x + b_t$$ 
für die Funktion $f$ an der Stelle $x_0$ die Gestalt:
$$t(x) = f(x_0) + f'(x_0) \cdot(x- x_0)$$
(Rechnen Sie das bitte nach!)

Die Tangente $t(x)$ ist dann die *beste lineare Näherung* der Funktion $f$ an 
der Stelle $x_0$!

Es ist somit für $x \approx x_0$:

$$f(x) \approx t(x) = f(x_0) + f'(x_0) \cdot(x- x_0)$$


## Ableitungsregeln

### Ableitung elementarer Funktionen

Für die folgenden *elementaren Funktionen* kann man expliziete Ableitungsregeln angeben.

Sei $f: D \to Z$ eine Funktion und $a>0$, $b$, $c$ reelle Zahlen. Dann gilt:

+------------+--------------------+-------------+----------------------------+
| $f(x)$     | $f'(x)$            | $f(x)$      | $f'(x)$                    | 
+:===========+:===================+=============+:===========================+
| $x^b$      | $b\cdot x^{b-1}$   | $c$         | $0$                        |
+------------+--------------------+-------------+----------------------------+
| $e^x$      | $e^x$              | $\log_a(x)$ | $\frac{1}{x \cdot \ln(a)}$ |
+------------+--------------------+-------------+----------------------------+
| $\ln(x)$   | $\frac{1}{x}$      | $a^x$       | $a^x \cdot \ln(a)$         |
+------------+--------------------+-------------+----------------------------+


### Übung


<!-- -->

### Summenregel

Sei $f(x) = g(x) +  h(x)$, dann gilt für die Ableitung gemäß **Summenregel**:

$$f'(x) = g'(x)+h'(x)$$

<!-- -->

### Produktregel

Sei $f(x) = g(x) \cdot h(x)$, dann gilt für die Ableitung gemäß Produktregel:

$$f'(x) = g'(x) \cdot h(x) + g(x) \cdot h'(x)$$

**Sonderfall:** *Produktregel mit Konstanter (Funktion)*

Sei $f(x) = c \cdot g(x)$, dann ist $f'(x)= c \cdot g'(x)$.

<!-- -->

### Quotientenregel

Sei $f(x) = \frac{g(x)}{h(x)}$, dann gilt für die Ableitung gemäß **Quotientenregel**:

$$f'(x) = \left(\frac{g(x)}{h(x)}\right)' = \frac{g'(x)\cdot h(x)- g(x) \cdot h'(x)}{\left(h(x)\right)^2}$$

<!-- -->

### Kettenregel

Sei $f(x) = g(h(x))$, dann gilt für die Ableitung gemäß Kettenregel:

$$f'(x) = \left(g\left(h(x)\right)\right)' = g'(h(x)) \cdot h'(x)$$

<!-- -->

## Extremstellen von Funktionen

### Monotonie

Eine Funktion deren Werte die auf einem Intervall $I$ nicht abnehmen heißt
**monoton steigend** und es gilt:
$$x < y \Longrightarrow f(x) \leq f(y) \quad \forall x,y \in I$$
Umgekehrt, nehmen die Werte auf einem Intervall $I$ nicht zu, dann heißt die
Funktion **monoton fallend** und es gilt:

$$x < y \Longrightarrow f(x) \geq f(y) \quad \forall x,y \in I$$
Gilt in beiden Fällen jeweils auf der rechten Seite die *strikte Ungleichung* 
($<$ bzw. $>$), so nennen wir die Funktionen auch **streng** *monoton* 
*steigend* bzw. *fallend*.

**Monotonie** setzt voraus, dass die *Steigungen* im jeweiligen Intervall $I$
*nicht negativ* (im *strengen* Fall *positiv*) bzw. 
*nicht postiv* (im strengen Fall *negativ*) sind.

Es gilt daher:

- $f$ ist auf $I$ *(streng) monoton steigend* 
  $\Longleftrightarrow f'(x) \geq (>) 0$
- $f$ ist auf $I$ *(streng) monoton fallend* 
  $\Longleftrightarrow f'(x) \leq (<) 0$


### Krümmung

Eine reellwertige Funktion heißt **konvex** auf dem Intervall $I$, wenn
für je zwei Stellen $a < b$ mit $a,b \in I$ die Funktionswerte von $f$ unterhalb
der Verbingdsstrecke von $(a; f(a))$ und $(b; f(b))$ liegt.
Liegen alle Funktionswerte oberhalb, so nennen wir die Funktion **konkav** auf 
$I$:

Es gilt dann:

- $f$ ist **konvex** auf $I$ $\Longleftrightarrow$ 
$\forall t \in [0,1], x, y \in I:$ 
$$f(t \cdot x + (1-t) \cdot y) \leq t\cdot f(x) + (1-t)\cdot f(y)$$


- $f$ ist **konkav** auf $I$ $\Longleftrightarrow$ 
$\forall t \in [0,1], x, y \in I:$ 
$$f(t \cdot x + (1-t) \cdot y) \geq t\cdot f(x) + (1-t)\cdot f(y)$$


### Zweite (und höhere) Ableitung

Falls für eine differenzierbare Funktion $f$ die Ableitungsfunktion $f'$ ebenfalls
differenzierbar ist, nennen wir diese **2. Ableitung von f** und schreiben 
dafür

$$f''(x) = \left[f'(x)\right]' = \frac{d}{dx} \left(\frac{d}{dx} f\right) = \frac{d^2}{dx^2} f$$

Rekursiv definieren wir die $n$-te Ableitung, falls die $n-1$ Ableitungfunktion
exisiert und differenzierbar ist. Wir schreiben dann:

$$f^{(n)}(x) = \left[f^{(n-1)}(x)\right]' = \frac{d}{dx} \left(\frac{d^{n-1}}{dx^{n-1}} f\right) = \frac{d^n}{dx^n} f$$

### Krümmung und die 2. Ableitung / Wendepunkte

Die 2. Ableitung einer Funktion beschreibt ihr Krümmungsverhalten, denn es gilt:

Eine *zweimal differenzierbare* Funktion $f$ ist auf dem Intervall $I$

- **(streng)** **konvex** $\Longleftrightarrow f''(x) (>)\geq 0$
- **(streng)** **konkav** $\Longleftrightarrow f''(x) (<)\leq 0$

für alle $x \in I$.

Der Punkt, an dem eine Funktion von einem konvexen Bereich in einen konkaven 
Bereich bzw. von einem konkaven in einen konvexen Bereich übergeht bezeichnen 
wir als **Wendepunkt**. 

Daher ist eine notwendige Bedingung für eine *Wendestelle* $x_{WP}$, dass 
$f''(x_{WP})=0$ gilt. Der *Wendepunkt* ist dann $(x_{WP}, f(x_{WP}))$.


### Globale und lokale Extremstellen




<!-- -->

## Univariate Funktionen


<!-- -->

### Partielle Ableitung

Werden für eine univariate, reellwertige Funktion 
$$f: D \to Z
    (x_1,\cdot,x_n) \mapsto y = f(x_1,\cdot,x_n)$$
Alle Variabeln $x_.$ bis auf die $i$-te als Konstanten betrachtet 
(c.p. = ceteris paribus), dann heißt die Ableitun von $f$ nach $x_i$ die 
**partielle Ableitung von $f$ nach $x_i$**:

$$\frac{\partial f(x_1,\dotsc,x_n)}{\partial x_1} = f_{x_i}(x_1,\cdot,x_n)$$

### Beispiele


### Gradient

Unter dem *Gradienten* einer univariaten, reellwertigen Funktion 
$$\begin{aligned}
f\,:\, & D \phantom{(x, \dotsc, x)}\to Z \\
       & (x_1, \dotsc, x_n) \mapsto\, y = f(x_1, \dotsc, x_n)
\end{aligned}$$

mit $D \subseteq \mathbf{R}^n$ und $Z \subseteq \mathbf{R}$ verstehen wir 
den Ausdruck

$$
\nabla f = \operatorname{grad}(f) =  \begin{pmatrix}\frac{\partial f}{\partial x_{1}}\\ \vdots\\ \frac{\partial f}{\partial x_{n}} \end{pmatrix},
$$
dem Vektor der partiellen Ableitung in die Richtungen $x_1, \dotsc, x_n$.


Der Gradient zeigt in die Richtung der größten Änderung.

Der Betrag des Gradienten gibt den Wert der größten Änderungsrate an
diesem Punkt an.


### Beispiel Gradient

Gegeben sei ein Funktion $f: \mathbf{R}^2 \to \mathbf{R}$ mittels
$f(x,y)=2x^2-y^2.$ 
Die partiellen Ableitungen sind somit $\frac{{\partial f}}{{\partial x}} = 4x$
und $\frac{{\partial f}}{{\partial y}} = -2y$.

Damit ist 
$\operatorname{grad}(f) = \nabla f = \begin{pmatrix}4x\\-2y\end{pmatrix}.$

Für den Punkt $P(-2; -1)$ lautet der Gradientvektor 
$\begin{pmatrix}-8\\2\end{pmatrix}$.

Der Betrag ist 
$\left|\begin{pmatrix}-8\\2\\\end{pmatrix}\right| = \sqrt{(-8)^2 + 2^2} \approx 8{,}25$.


### 3D-Plot von $f(x,y)=2x^2-y^2$ 

```{r echo=FALSE}
fkt <- function(x,y) {
  return(2*x^2 - y^2)
}

x <- seq(-5, 5, 0.1)
y <- seq(-5, 5, 0.1)
z <- array(0:0, c(length(x),length(y)))

xi <- 0
yi <- 0

for (xx in x) {
  xi <- xi + 1
  yi <- 0
  for (yy in y) {
    yi <- yi + 1
    z[xi,yi] <- fkt(xx, yy)
  }
}


```

```{r echo=FALSE}
library("plot3D")
t <- seq(-5, 5, 0.1)
m <- mesh(t, t)
x <- m$x
y <- m$y
z <- fkt(x,y)

persp3D(x, y, z, 
        box=TRUE, 
        phi=30, 
        theta= 35,
        nticks=5,
        axes=TRUE,
        scale=1.5,
        ticktype="detailed",
        colkey = list(
          length = 0.5, 
          width = 0.5, 
          shift = 0.15,
        cex.axis = 0.8, cex.clab = 0.85),
        boder = TRUE,
        clab = c("z = f(x,y)"),
        plot=TRUE,
        colvar=z)
```




## Extremstellen univariaten Funktionen



### Notwendigebedinung 1 / stationäre Punkte

Damit ein Punkt $x=(x_1, \dotsc, x_n) \in D \subseteq \mathbf{R}^n$ eine 
Extremstelle der Funktion $f:D \to Z \subseteq \mathbf{R}$ seien
kann, muss für den Gradient gelten:

$$\nabla f(x) = 0^n = \begin{pmatrix}0\\ \vdots \\0\end{pmatrix} \in \mathbf{R}^n$$

Punkte welche diese Bedingung erfüllen, nennen wir **stationäre Punkte**.

Mathematisch heißt das:

$$x \text{ ist eine Extremstelle von } f \Longrightarrow \nabla f(x) = 0^n$$

### Beispiel

Aus dem Beispiel $f(x,y)=2x^2-y^2$ mit dem Gradienten 
$\nabla f(x,y) = \begin{pmatrix}4x\\-2y\end{pmatrix}$ wissen wir, dass
der Punkt $(0; 0)$ ein *stationärer Punkt* ist, weil 
$$\nabla f(0,0) = \begin{pmatrix}\phantom{-}4\cdot 0\\-2 \cdot 0\end{pmatrix}= \begin{pmatrix}0\\0\end{pmatrix}$$
gilt.
Aber aus dem 3D Plot wissen wir, dass $(0; 0)$ keine Extremstelle ist!


### Hesse-Matrix

Für eine hinreichend oft differenzierbare Funktion $f: D \to Z$, mit 
$D \subseteq \mathbf{R}^n$ und $Z \subseteq \mathbf{R}$ ist für ein 
$x \in D$ die **Hesse-Matrix** wie folgt gegeben:

$$
\operatorname{Hess}\left(f(x)\right) =
\begin{pmatrix}
 f_{x_1x_1}(x) & f_{x_1x_2}(x) & \cdots & f_{x_1x_n}(x) \\
 f_{x_2x_1}(x) & f_{x_2x_2}(x) & \cdots & f_{x_2x_n}(x) \\
 \vdots        & \vdots        & \ddots & \vdots \\
 f_{x_nx_1}(x) & f_{x_nx_2}(x) & \cdots & f_{x_nx_n}(x)
\end{pmatrix}
$$

### KLassifikation stationärer Punkte

Sie $f: D \to Z$ eine hinreichend differenzierbare Funktion und 
$D \subseteq \mathbf{R}^n$ und $Z \subseteq \mathbf{R}$.und $x_0$ ein
stationärer Punkt ($\nabla f(x_0) = 0^n$).

a) **Notwendige Bedingung:**
   Ist $x_0$ ein lokales Extremum von $f(x)$, so gilt:
   
   - $x_0$ ist lokales Minimum $\Longrightarrow$ 
     $\operatorname{Hess}\left(f(x_0)\right)$ ist positiv semidefinit 
    
   - $x_0$ ist lokales Maximum $\Longrightarrow$ 
     $\operatorname{Hess}\left(f(x_0)\right)$ ist negativ semidefinit 

b) **Hinreichende Bedingung:**
   
   - Ist $\operatorname{Hess}\left(f(x_0)\right)$ positiv definit 
     (bzw. negativ definit), so ist $x_0$ ein strenges lokales Minimum 
     (bzw. Maximum) von $f(x)$.
     
   - Ist $\operatorname{Hess}\left(f(x_0)\right)$ indefinit, so ist
     $x_0$ ein Sattelpunkt.


<!-- -->


### Beispiel $f(x,y) = 4x^2+xy+7x+3y^2-5y$

Für $f(x,y) = 4x^2+xy+7x+3y^2-5y$ lautet der Gradient

$$\nabla f = \begin{pmatrix}8x+y+7\\x+6y-5\end{pmatrix}$$
und hat den stationären Punkt $(-1; 1)$. (TR!)

Die Hesse-Matrix für den Punkt $(-1; 1)$ lautet:
$$\operatorname{Hess}\left(f(1,1)\right) = \begin{pmatrix}
 8 & 1  \\
 1 & 6
\end{pmatrix}$$

Das charakteristische Polynom $\chi(\lambda) = (8-\lambda)(6-\lambda)-1=x^2-14x+49 = (x-7)^2$
liefert die Eigenwerte $\lambda_1=7$ und $\lambda_2=7$.

Da beide Eigenwerte positiv sind ist die Hesse-Matrix positiv definit und wir
haben an der Stelle $(-1; 1)$ ein strenges lokales Minimum.


### Beispiel $f(x,y) = -3x^2+xy+5x-4y^2+7y$

Für $f(x,y) = -3x^2+xy+5x-4y^2+7y$ lautet der Gradient

$$\nabla f = \begin{pmatrix}-6x+\phantom{8}y+5\\\phantom{-6}x-8y+7\end{pmatrix}$$
und hat den stationären Punkt $(1; 1)$. (TR!)

Die Hesse-Matrix für den Punkt $(-1; 1)$ lautet:

$$\operatorname{Hess}\left(f(1,1)\right) = \begin{pmatrix}
 -6 & 1  \\
 1 & -8
\end{pmatrix}$$

Das charakteristische Polynom $\chi(\lambda) = (-6-\lambda)(-8-\lambda)-1=x^2+14x+49 = (x+7)^2$
liefert die Eigenwerte $\lambda_1=-7$ und $\lambda_2=-7$.

Da beide Eigenwerte negativ sind ist die Hesse-Matrix negativ definit und wir
haben an der Stelle $(1; 1)$ ein strenges lokales Maximum.


### Beispiel $f(x,y)=2x^2-y^2$

Für $f(x,y)=2x^2-y^2$ lautet der Gradient 

$$\nabla f= \begin{pmatrix}4x\\-2y\end{pmatrix}$$

Es gibt einen stationären Punkt $(0; 0)$ und die Hesse-Matrix lautet:

$$\operatorname{Hess}\left(f(x,y)\right) = \begin{pmatrix}
 4 & 0  \\
 0 & -2
\end{pmatrix}$$

Da die Hesse-Matrix in diagonalgestalt ist, können wir die Eigenwerte ablesen:
$\lambda_1 = 4$, $\lambda_2 = -2$.

Da die beiden Eigenwerte unterschiedliche Vorzeichen haben, ist die 
Hesse-Matrix indefinit. 

Der Punkt $(0; 0)$ liefert somit einen Sattelpunkt.


### Übungen:
<!-- Aufgabe von Ross/Christians -->

Bestimmen Sie für die folgenden Funktionen den stationären Punkt $(x_0; y_0)$
und geben Sie an, ob es sich um eine Maximum, Minimum oder einen Sattelpunkt 
handelt:

a) $f(x,y) = -x^2+24x-2y^2+40y-2xy-3$
b) $f(x,y) = 2x^2-24x+2y^2-18y+2xy+3$
c) $f(x,y) = 2x^2-10x-2y^2+2xy-2$
d) $f(x,y) = x^2+24x+2y^2+40y-3xy$
e) $f(x,y) = 2x^2-30x+3y^2-10y-2xy$
f) $f(x,y) = -2x^2+24x-5y^2+5xy-1$
g) $f(x,y) = x^2+4x-5y^2+10y-4xy$
h) $f(x,y) = -x^2+120x+2y^2+120y-4xy$


### Übung

Die Funktion $f(x,y) = y^2(x-1) + x^2(x+1)$ besitzt **zwei** stationäre Punkte.

a) Bestimmen Sie die beiden stationären Punkt $(x_0;y_0)$ und $(x_1; y_1)$.

b) Berechnen Sie die Hesse-Matrizen und entscheiden Sie, ob die Punkte lokale 
   Extremstellen sind (und welcher Typ) oder Sattelpunkte.


### Minimierungsproblem
...

<!-- -->


### Maximierungsproblem
...

<!-- -->


### Ausblick: Gradientenverfahren
...

<!-- -->


## Extrema unter Nebenbedingungen 

### Das allgemeine Problem

Gegeben ist eine (Ziel-)Funktion $f: D \to Z$ mit $D \subseteq\mathbf{R}^n$ und
$Z \subseteq \mathbf{R}$. Weiterhin seien $m$ verschiedene Nebenbedingungen in 
der Form $g_i: D \to Z$ ($i=1,...,m)$ mit $g_i(x) = 0$.

Wir suchen nun das $x$ aus der Menge der aller $x$, welche die Nebenbedingungen 
$g_i$ erfüllen, bei dem $f(x)$ den größten bzw. kleinsten Wert annimmt.




### Lagrangemethode

Wir formulieren zunächst eine *Lagrangefunktion* $L_f(x,\lambda)$ mit 
$x\in\mathbf{R}^n$ und $\lambda=\mathbf{R}^m$ mittels:

$$L_f(x_1,...x_n,\lambda_1,...\lambda_m) = f(x_1,...,x_n) + \sum_{i=1}^m \lambda_i \cdot g_i$$
Bestimmt man nun die Lösung von 

$$\nabla L_f(x,\lambda) = 0^{n+m}$$

So liefern die Werte $x_1,...,x_n$ die gesuchte(n) Werte für eine Extremstelle.


### Beispiel

Betrachtet werden zwei Güter, deren Konsummengen $x_1$ und $x_2$ dem Verbraucher 
einen Nutzen stiften, der durch die Nutzenfunktion $U(x_1,x_2)=x_1 \cdot x_2$ 
beschrieben wird. 

Weiterhin verfügt der Verbraucher über ein begrenztes Einkommen in Höhe von 
$Y = 300$, und die Preise der beiden Güter sind $p_1 = 3$ und $p_2 = 6$. 


*Wir erhalten:* Zielfunktion $f(x_1, x_2) = U(x_1, x_2) = x_1 \cdot x_2$ und 
Nebenbedingung $g(x_1, x_2) = 300 - (3 x_1 + 6 x_2)$

Die Lagrangefunktion lautet dann:
$$L(x_1, x_2, \lambda) = x_1 \cdot x_2 + \lambda (300 - 3 x_1 - 6 x_2)$$
Damit ist

$$\nabla L(x_1, x_2, \lambda) = \begin{pmatrix} x_2 - 3 \lambda\\ x_1 - 6 \lambda \\ 300 - 3 x_1 - 6 x_2\end{pmatrix}$$

Und wir erhalten als Lösung von $\nabla L(x_1, x_2, \lambda) = 0^3$:
$x_1=50$, $x_2=25$, $\lambda=25/3$


### Einsetzungsverfahren {include-only=LangeFassung}
...

<!-- -->


## Taylorreihe {include-only=LangeFassung}
...

<!-- -->

### ...

...

```{r finish-Differenzialrechnung, include=FALSE}
finalizePart(partname)
```